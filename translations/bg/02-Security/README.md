# MCP Security: Всеобхватна защита за AI системи

[![MCP Security Best Practices](../../../translated_images/bg/03.175aed6dedae133f9d41e49cefd0f0a9a39c3317e1eaa7ef7182696af7534308.png)](https://youtu.be/88No8pw706o)

_(Кликнете върху изображението по-горе, за да гледате видеото на този урок)_

Сигурността е основополагаща за проектирането на AI системи, затова я поставяме като втория ни раздел. Това съответства на принципа на Microsoft **Secure by Design** от [Secure Future Initiative](https://www.microsoft.com/security/blog/2025/04/17/microsofts-secure-by-design-journey-one-year-of-success/).

Протоколът за контекст на модела (MCP) предоставя мощни нови възможности за AI-базирани приложения, като същевременно въвежда уникални предизвикателства за сигурността, които надхвърлят традиционните рискове при софтуера. MCP системите се сблъскват както с установени проблеми със сигурността (сигурно кодиране, принцип на най-малко привилегии, сигурност на веригата за доставки), така и с нови специфични за AI заплахи, включително инжектиране на подсказки, отравяне на инструменти, отвличане на сесии, атаки на объркан заместник, уязвимости при предаване на токени и динамична модификация на възможности.

Този урок разглежда най-критичните рискове за сигурността при реализации на MCP — обхващащи удостоверяване, упълномощаване, прекомерни разрешения, индиректно инжектиране на подсказки, сигурност на сесиите, проблеми с объркан заместник, управление на токени и уязвимости във веригата за доставки. Ще научите приложими контроли и най-добри практики за смекчаване на тези рискове, като използвате решения на Microsoft като Prompt Shields, Azure Content Safety и GitHub Advanced Security за укрепване на вашето MCP внедряване.

## Учебни цели

Към края на този урок ще можете да:

- **Идентифицирате специфични за MCP заплахи**: Разпознавате уникални рискове за сигурността в MCP системи, включително инжектиране на подсказки, отравяне на инструменти, прекомерни разрешения, отвличане на сесии, проблеми с объркан заместник, уязвимости при предаване на токени и рискове във веригата за доставки
- **Прилагате контроли за сигурност**: Изпълнявате ефективни мерки за смекчаване, включително стабилно удостоверяване, достъп с най-малко привилегии, сигурно управление на токени, контроли за сигурност на сесиите и проверка на веригата за доставки
- **Използвате решения за сигурност на Microsoft**: Разбирате и внедрявате Microsoft Prompt Shields, Azure Content Safety и GitHub Advanced Security за защита на MCP натоварвания
- **Валидирате сигурността на инструментите**: Разпознавате важността на валидирането на метаданни на инструменти, мониторинга за динамични промени и защитата срещу индиректни атаки с инжектиране на подсказки
- **Интегрирате най-добри практики**: Комбинирате установени основи на сигурността (сигурно кодиране, затвърждаване на сървъри, zero trust) с MCP-специфични контроли за всеобхватна защита

# Архитектура и контроли за сигурност на MCP

Модерните реализации на MCP изискват многостепенни подходи за сигурност, които адресират както традиционната софтуерна сигурност, така и специфичните за AI заплахи. Бързо развиващата се спецификация на MCP продължава да усъвършенства своите контроли за сигурност, позволявайки по-добра интеграция с корпоративни архитектури за сигурност и установени най-добри практики.

Изследвания от [Microsoft Digital Defense Report](https://aka.ms/mddr) показват, че **98% от докладваните пробиви биха били предотвратени чрез стабилна хигиена на сигурността**. Най-ефективната стратегия за защита комбинира основни практики за сигурност с MCP-специфични контроли — доказаните базови мерки за сигурност остават най-въздействащи за намаляване на общия риск.

## Текуща картина на сигурността

> **Забележка:** Тази информация отразява стандартите за сигурност на MCP към **18 декември 2025 г.** Протоколът MCP продължава да се развива бързо и бъдещите реализации могат да въведат нови модели за удостоверяване и подобрени контроли. Винаги се консултирайте с актуалната [MCP Спецификация](https://spec.modelcontextprotocol.io/), [MCP GitHub хранилище](https://github.com/modelcontextprotocol) и [документация за най-добри практики за сигурност](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices) за последните насоки.

### Еволюция на удостоверяването в MCP

Спецификацията на MCP значително се е развила в подхода си към удостоверяване и упълномощаване:

- **Първоначален подход**: Ранните спецификации изискваха разработчиците да внедрят собствени сървъри за удостоверяване, като MCP сървърите действаха като OAuth 2.0 сървъри за упълномощаване, управляващи директно удостоверяването на потребителите
- **Текущ стандарт (2025-11-25)**: Актуализираната спецификация позволява MCP сървърите да делегират удостоверяването на външни доставчици на идентичност (като Microsoft Entra ID), подобрявайки сигурността и намалявайки сложността на реализацията
- **Сигурност на транспортния слой**: Подобрена поддръжка за сигурни транспортни механизми с правилни модели за удостоверяване както за локални (STDIO), така и за отдалечени (Streamable HTTP) връзки

## Сигурност на удостоверяване и упълномощаване

### Текущи предизвикателства за сигурността

Модерните реализации на MCP се сблъскват с няколко предизвикателства при удостоверяване и упълномощаване:

### Рискове и вектори на атака

- **Грешно конфигурирана логика за упълномощаване**: Недостатъчното прилагане на упълномощаване в MCP сървърите може да изложи чувствителни данни и да приложи неправилно контролите за достъп
- **Компрометиране на OAuth токени**: Кражба на токени от локален MCP сървър позволява на нападатели да се представят за сървъри и да получат достъп до downstream услуги
- **Уязвимости при предаване на токени**: Неправилното боравене с токени създава заобикаляния на контроли за сигурност и пропуски в отчетността
- **Прекомерни разрешения**: MCP сървъри с прекомерни права нарушават принципа на най-малко привилегии и разширяват повърхността на атака

#### Предаване на токени: Критичен анти-патърн

**Предаването на токени е изрично забранено** в текущата спецификация за упълномощаване на MCP поради сериозни последици за сигурността:

##### Заобикаляне на контроли за сигурност
- MCP сървърите и downstream API-тата прилагат критични контроли за сигурност (ограничаване на честотата, валидиране на заявки, мониторинг на трафика), които зависят от правилна валидация на токени
- Директната употреба на токени от клиент към API заобикаля тези съществени защити, подкопавайки архитектурата за сигурност

##### Предизвикателства при отчетност и одит  
- MCP сървърите не могат да различат клиентите, използващи токени, издадени от upstream, което нарушава одитните следи
- Логовете на downstream ресурсните сървъри показват подвеждащи източници на заявки, а не реалните MCP сървърни посредници
- Разследването на инциденти и одитът за съответствие стават значително по-трудни

##### Рискове от изтичане на данни
- Невалидираните твърдения в токените позволяват на злонамерени лица с откраднати токени да използват MCP сървъри като проксита за изтичане на данни
- Нарушения на границите на доверие позволяват неоторизиран достъп, който заобикаля предвидените контроли за сигурност

##### Вектори на атака с множество услуги
- Компрометирани токени, приети от множество услуги, позволяват странично движение между свързани системи
- Доверителните предположения между услуги могат да бъдат нарушени, когато произходът на токените не може да бъде проверен

### Контроли за сигурност и мерки за смекчаване

**Критични изисквания за сигурност:**

> **ЗАДЪЛЖИТЕЛНО**: MCP сървърите **НЕ ТРЯБВА** да приемат никакви токени, които не са изрично издадени за MCP сървъра

#### Контроли за удостоверяване и упълномощаване

- **Строг преглед на упълномощаването**: Провеждайте цялостни одити на логиката за упълномощаване на MCP сървъри, за да гарантирате, че само предвидените потребители и клиенти имат достъп до чувствителни ресурси
  - **Ръководство за реализация**: [Azure API Management като шлюз за удостоверяване за MCP сървъри](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
  - **Интеграция на идентичност**: [Използване на Microsoft Entra ID за удостоверяване на MCP сървър](https://den.dev/blog/mcp-server-auth-entra-id-session/)

- **Сигурно управление на токени**: Прилагайте [най-добри практики на Microsoft за валидация и жизнен цикъл на токени](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens)
  - Валидирайте твърденията за аудитория на токена, съвпадащи с идентичността на MCP сървъра
  - Прилагайте правилна ротация и политики за изтичане на токени
  - Предотвратявайте повторно използване на токени и неоторизирана употреба

- **Защитено съхранение на токени**: Сигурно съхранение на токени с криптиране както в покой, така и при пренос
  - **Най-добри практики**: [Насоки за сигурно съхранение и криптиране на токени](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

#### Прилагане на контрол на достъпа

- **Принцип на най-малко привилегии**: Предоставяйте на MCP сървърите само минималните разрешения, необходими за предвидената функционалност
  - Редовни прегледи и актуализации на разрешенията за предотвратяване на нарастване на привилегиите
  - **Документация на Microsoft**: [Сигурен достъп с най-малко привилегии](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)

- **Контрол на достъпа на базата на роли (RBAC)**: Прилагайте фино настроени ролеви назначения
  - Ограничете ролите строго до конкретни ресурси и действия
  - Избягвайте широки или ненужни разрешения, които разширяват повърхността на атака

- **Непрекъснат мониторинг на разрешенията**: Внедрете постоянен одит и мониторинг на достъпа
  - Следете модели на използване на разрешения за аномалии
  - Бързо отстранявайте прекомерни или неизползвани привилегии

## Специфични за AI заплахи за сигурността

### Атаки с инжектиране на подсказки и манипулация на инструменти

Модерните реализации на MCP се сблъскват със сложни AI-специфични вектори на атака, които традиционните мерки за сигурност не могат напълно да адресират:

#### **Индиректно инжектиране на подсказки (Cross-Domain Prompt Injection)**

**Индиректното инжектиране на подсказки** представлява една от най-критичните уязвимости в AI системи с MCP. Нападателите вграждат злонамерени инструкции в външно съдържание — документи, уеб страници, имейли или източници на данни, които AI системите след това обработват като легитимни команди.

**Сценарии на атака:**
- **Инжектиране в документи**: Злонамерени инструкции, скрити в обработвани документи, които задействат нежелани AI действия
- **Експлоатация на уеб съдържание**: Компрометирани уеб страници с вградени подсказки, които манипулират поведението на AI при извличане
- **Атаки чрез имейл**: Злонамерени подсказки в имейли, които карат AI асистенти да изтичат информация или да извършват неоторизирани действия
- **Замърсяване на източници на данни**: Компрометирани бази данни или API-та, които предоставят заразено съдържание на AI системи

**Реално въздействие**: Тези атаки могат да доведат до изтичане на данни, нарушения на поверителността, генериране на вредно съдържание и манипулация на взаимодействия с потребителите. За подробен анализ вижте [Prompt Injection в MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/).

![Prompt Injection Attack Diagram](../../../translated_images/bg/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.png)

#### **Атаки с отравяне на инструменти**

**Отравянето на инструменти** цели метаданните, които дефинират MCP инструментите, експлоатирайки начина, по който големите езикови модели интерпретират описанията и параметрите на инструментите за вземане на решения за изпълнение.

**Механизми на атака:**
- **Манипулация на метаданни**: Нападателите инжектират злонамерени инструкции в описания на инструменти, дефиниции на параметри или примери за употреба
- **Невидими инструкции**: Скритите подсказки в метаданните на инструменти, които се обработват от AI модели, но са невидими за човешки потребители
- **Динамична модификация на инструменти („Rug Pulls“) **: Инструменти, одобрени от потребителите, по-късно се модифицират да извършват злонамерени действия без знанието на потребителя
- **Инжектиране на параметри**: Злонамерено съдържание, вградено в схеми на параметри на инструменти, което влияе на поведението на модела

**Рискове при хоствани сървъри**: Отдалечените MCP сървъри представляват повишени рискове, тъй като дефинициите на инструментите могат да се актуализират след първоначалното одобрение от потребителя, създавайки сценарии, при които преди безопасни инструменти стават злонамерени. За пълен анализ вижте [Атаки с отравяне на инструменти (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks).

![Tool Injection Attack Diagram](../../../translated_images/bg/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.png)

#### **Допълнителни AI вектори на атака**

- **Инжектиране на подсказки от множество домейни (XPIA)**: Сложни атаки, които използват съдържание от няколко домейна за заобикаляне на контроли за сигурност
- **Динамична модификация на възможности**: Промени в реално време на възможностите на инструментите, които избягват първоначалните оценки за сигурност
- **Отравяне на контекстното прозорче**: Атаки, които манипулират големи контекстни прозорци, за да скрият злонамерени инструкции
- **Атаки за объркване на модела**: Експлоатиране на ограниченията на модела за създаване на непредсказуемо или несигурно поведение

### Въздействие на рисковете за AI сигурността

**Високовъздействени последици:**
- **Изтичане на данни**: Неоторизиран достъп и кражба на чувствителни корпоративни или лични данни
- **Нарушения на поверителността**: Разкриване на лична идентифицираща информация (PII) и конфиденциални бизнес данни  
- **Манипулация на системи**: Непредвидени модификации на критични системи и работни потоци
- **Кражба на идентификационни данни**: Компрометиране на токени за удостоверяване и служебни идентификационни данни
- **Странично движение**: Използване на компрометирани AI системи като отправна точка за по-широки мрежови атаки

### Решения за AI сигурност на Microsoft

#### **AI Prompt Shields: Разширена защита срещу атаки с инжектиране**

Microsoft **AI Prompt Shields** предоставят всеобхватна защита както срещу директни, така и срещу индиректни атаки с инжектиране на подсказки чрез множество слоеве на сигурност:

##### **Основни механизми за защита:**

1. **Разширено откриване и филтриране**
   - Машинно обучение и NLP техники откриват злонамерени инструкции във външно съдържание
   - Анализ в реално време на документи, уеб страници, имейли и източници на данни за вградени заплахи
   - Контекстуално разбиране на легитимни спрямо злонамерени модели на подсказки

2. **Техники за осветяване**  
   - Разграничават доверени системни инструкции от потенциално компрометирани външни входни данни
   - Методи за трансформация на текст, които подобряват релевантността на модела, като изолират злонамерено съдържание
   - Помагат на AI системите да поддържат правилна йерархия на инструкциите и да игнорират инжектирани команди

3. **Системи за разделители и маркиране на данни**
   - Ясно дефиниране на границите между доверени системни съобщения и външен входен текст
   - Специални маркери, които подчертават границите между доверени и недоверени източници на данни
   - Ясно разделяне, което предотвратява объркване на инструкции и неоторизирано изпълнение на команди

4. **Непрекъсната разузнавателна информация за заплахи**
   - Microsoft непрекъснато следи нови модели на атаки и актуализира защитите
   - Проактивно търсене на нови техники за инжектиране и вектори на атака
   - Редовни актуализации на моделите за сигурност за поддържане на ефективност срещу развиващи се заплахи

5. **Интеграция с Azure Content Safety**
   - Част от цялостния пакет Azure AI Content Safety
   - Допълнително откриване на опити за jailbreak, вредно съдържание и нарушения на политики за сигурност
   - Унифицирани контроли за сигурност в компонентите на AI приложенията

**Ресурси за реализация**: [Документация на Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)

![Microsoft Prompt Shields Protection](../../../translated_images/bg/prompt-shield.ff5b95be76e9c78c6ec0888206a4a6a0a5ab4bb787832a9eceef7a62fe0138d1.png)


## Разширени заплахи за сигурността на MCP

### Уязвимости при отвличане на сесии

**Отвличането на сесии** представлява критичен вектор на атака в състояниеви реализации на MCP, при които неоторизирани лица получават и злоупотребяват с легитимни идентификатори на сесии, за да се представят за клиенти и извършват неоторизирани действия.

#### **Сценарии на атака и рискове**

- **Отвличане на сесия с инжектиране на подсказки**: Нападатели със откраднати идентификатори на сесии инжектират злонамерени събития в сървъри, споделящи състояние на сесията, което може да задейства вредни действия или достъп до чувствителни данни
- **Директно представяне**: Откраднати идентификатори на сесии позволяват директни повиквания към MCP сървъра, които заобикалят удостоверяването, третирайки нападателите като легитимни потребители
- **Компрометирани възобновяеми потоци**: Нападатели могат да прекратят заявки преждевременно, карайки легитимни клиенти да възобновят с потенциално злонамерено съдържание

#### **Контроли за сигурност при управление на сесии**

**Критични изисквания:**
- **Проверка на упълномощаването**: MCP сървърите, които прилагат упълномощаване, **ТРЯБВА** да проверяват ВСИЧКИ входящи заявки и **НЕ ТРЯБВА** да разчитат на сесии за удостоверяване
- **Сигурно генериране на сесии**: Използвайте криптографски сигурни, недетерминистични идентификатори на сесии, генерирани с помощта на сигурни генератори на случайни числа
- **Свързване със специфичен потребител**: Свържете идентификаторите на сесии с информация, специфична за потребителя, използвайки формати като `<user_id>:<session_id>`, за да предотвратите злоупотреба със сесии между потребители
- **Управление на жизнения цикъл на сесията**: Прилагайте правилно изтичане, ротация и невалидиране, за да ограничите уязвимите прозорци
- **Сигурност на транспорта**: Задължителен HTTPS за цялата комуникация, за да се предотврати прихващане на идентификатори на сесии

### Проблемът с объркания заместник

**Проблемът с объркания заместник** възниква, когато MCP сървърите действат като прокси за удостоверяване между клиентите и трети страни, създавайки възможности за заобикаляне на упълномощаването чрез експлоатация на статични клиентски идентификатори.

#### **Механизми на атака и рискове**

- **Заобикаляне на съгласие чрез бисквитки**: Предишното удостоверяване на потребителя създава бисквитки за съгласие, които нападателите използват чрез злонамерени заявки за упълномощаване с изработени URI за пренасочване
- **Кражба на код за упълномощаване**: Съществуващите бисквитки за съгласие могат да накарат сървърите за упълномощаване да пропуснат екраните за съгласие, пренасочвайки кодове към контролирани от нападателя крайни точки  
- **Неоторизиран достъп до API**: Откраднатите кодове за упълномощаване позволяват обмен на токени и имитация на потребител без изрично одобрение

#### **Стратегии за смекчаване**

**Задължителни контроли:**
- **Изисквания за изрично съгласие**: MCP прокси сървърите, използващи статични клиентски идентификатори, **ТРЯБВА** да получават съгласие от потребителя за всеки динамично регистриран клиент
- **Прилагане на OAuth 2.1 сигурност**: Следвайте текущите най-добри практики за сигурност на OAuth, включително PKCE (Proof Key for Code Exchange) за всички заявки за упълномощаване
- **Строга валидация на клиента**: Прилагайте стриктна валидация на URI за пренасочване и идентификатори на клиенти, за да предотвратите експлоатация

### Уязвимости при пропускане на токени  

**Пропускането на токени** представлява явен анти-патърн, при който MCP сървърите приемат клиентски токени без подходяща валидация и ги препращат към downstream API, нарушавайки спецификациите за упълномощаване на MCP.

#### **Импликации за сигурността**

- **Заобикаляне на контроли**: Директната употреба на токени от клиент към API заобикаля критични контроли за ограничаване на честотата, валидация и мониторинг
- **Корупция на одитния след**: Токени, издадени upstream, правят невъзможна идентификацията на клиента, нарушавайки възможностите за разследване на инциденти
- **Изтичане на данни чрез прокси**: Невалидираните токени позволяват на злонамерени лица да използват сървърите като проксита за неоторизиран достъп до данни
- **Нарушаване на границите на доверие**: Доверителните предположения на downstream услуги могат да бъдат нарушени, когато произходът на токените не може да бъде проверен
- **Разширяване на атаки към множество услуги**: Компрометирани токени, приети в множество услуги, позволяват странично движение

#### **Изисквани контроли за сигурност**

**Неподлежащи на преговор изисквания:**
- **Валидация на токени**: MCP сървърите **НЕ ТРЯБВА** да приемат токени, които не са изрично издадени за MCP сървъра
- **Проверка на аудиторията**: Винаги валидирайте, че претенциите за аудитория на токена съвпадат с идентичността на MCP сървъра
- **Правилен жизнен цикъл на токена**: Прилагайте краткоживотни токени за достъп с практики за сигурна ротация


## Сигурност на веригата за доставки за AI системи

Сигурността на веригата за доставки се е развила отвъд традиционните софтуерни зависимости, за да обхване цялата AI екосистема. Модерните реализации на MCP трябва стриктно да проверяват и наблюдават всички AI свързани компоненти, тъй като всеки от тях въвежда потенциални уязвимости, които могат да компрометират целостта на системата.

### Разширени компоненти на AI веригата за доставки

**Традиционни софтуерни зависимости:**
- Отворени библиотеки и рамки
- Контейнерни образи и базови системи  
- Инструменти за разработка и билд пайплайни
- Инфраструктурни компоненти и услуги

**AI-специфични елементи на веригата за доставки:**
- **Фондационни модели**: Предварително обучени модели от различни доставчици, изискващи проверка на произхода
- **Услуги за вграждане**: Външни услуги за векторизация и семантично търсене
- **Доставчици на контекст**: Източници на данни, бази знания и хранилища на документи  
- **API на трети страни**: Външни AI услуги, ML пайплайни и крайни точки за обработка на данни
- **Артефакти на модели**: Тежести, конфигурации и фино настроени варианти на модели
- **Източници на тренировъчни данни**: Набори от данни, използвани за обучение и фино настройване на модели

### Всеобхватна стратегия за сигурност на веригата за доставки

#### **Верификация на компоненти и доверие**
- **Проверка на произхода**: Проверявайте произхода, лицензирането и целостта на всички AI компоненти преди интеграция
- **Оценка на сигурността**: Провеждайте сканиране за уязвимости и прегледи на сигурността за модели, източници на данни и AI услуги
- **Анализ на репутацията**: Оценявайте историята на сигурността и практиките на доставчиците на AI услуги
- **Проверка на съответствието**: Уверете се, че всички компоненти отговарят на организационните изисквания за сигурност и регулации

#### **Сигурни пайплайни за внедряване**  
- **Автоматизирана CI/CD сигурност**: Интегрирайте сканиране за сигурност през целия автоматизиран пайплайн за внедряване
- **Целостта на артефактите**: Прилагайте криптографска верификация за всички внедрени артефакти (код, модели, конфигурации)
- **Стъпково внедряване**: Използвайте прогресивни стратегии за внедряване с валидация на сигурността на всеки етап
- **Доверени хранилища за артефакти**: Внедрявайте само от проверени, сигурни регистри и хранилища за артефакти

#### **Непрекъснат мониторинг и реакция**
- **Сканиране на зависимости**: Постоянен мониторинг за уязвимости на всички софтуерни и AI зависимости
- **Мониторинг на модели**: Непрекъсната оценка на поведението на моделите, отклонения в производителността и аномалии в сигурността
- **Проследяване на здравето на услугите**: Наблюдение на външни AI услуги за наличност, инциденти със сигурността и промени в политиките
- **Интеграция на разузнаване за заплахи**: Включване на потоци с информация за заплахи, специфични за AI и ML рискове

#### **Контрол на достъпа и принцип на най-малко привилегии**
- **Разрешения на ниво компонент**: Ограничете достъпа до модели, данни и услуги според бизнес необходимостта
- **Управление на служебни акаунти**: Прилагайте отделни служебни акаунти с минимално необходимите разрешения
- **Сегментация на мрежата**: Изолирайте AI компонентите и ограничете мрежовия достъп между услугите
- **Контроли на API шлюзове**: Използвайте централизирани API шлюзове за контрол и мониторинг на достъпа до външни AI услуги

#### **Реакция при инциденти и възстановяване**
- **Процедури за бърза реакция**: Установени процеси за поправяне или замяна на компрометирани AI компоненти
- **Ротация на идентификационни данни**: Автоматизирани системи за ротация на тайни, API ключове и служебни идентификационни данни
- **Възможности за връщане назад**: Способност за бързо връщане към предишни известни добри версии на AI компоненти
- **Възстановяване при пробив в веригата за доставки**: Специфични процедури за реакция при компрометиране на upstream AI услуги

### Инструменти за сигурност на Microsoft и интеграция

**GitHub Advanced Security** предоставя цялостна защита на веригата за доставки, включително:
- **Сканиране за тайни**: Автоматично откриване на идентификационни данни, API ключове и токени в хранилищата
- **Сканиране на зависимости**: Оценка на уязвимости за отворени зависимости и библиотеки
- **CodeQL анализ**: Статичен анализ на кода за уязвимости и проблеми в кодирането
- **Информация за веригата за доставки**: Видимост върху здравето и състоянието на зависимостите

**Интеграция с Azure DevOps и Azure Repos:**
- Безпроблемна интеграция на сканиране за сигурност в платформите за разработка на Microsoft
- Автоматизирани проверки за сигурност в Azure Pipelines за AI натоварвания
- Прилагане на политики за сигурно внедряване на AI компоненти

**Вътрешни практики на Microsoft:**
Microsoft прилага обширни практики за сигурност на веригата за доставки във всички продукти. Научете за доказани подходи в [The Journey to Secure the Software Supply Chain at Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/).


## Най-добри практики за основна сигурност

Реализациите на MCP наследяват и надграждат съществуващата сигурност на вашата организация. Укрепването на основните практики за сигурност значително подобрява цялостната сигурност на AI системите и внедряванията на MCP.

### Основни принципи на сигурността

#### **Практики за сигурна разработка**
- **Съответствие с OWASP**: Защита срещу [OWASP Top 10](https://owasp.org/www-project-top-ten/) уязвимости в уеб приложения
- **AI-специфични защити**: Прилагане на контроли за [OWASP Top 10 за LLM](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- **Сигурно управление на тайни**: Използване на специализирани хранилища за токени, API ключове и чувствителни конфигурационни данни
- **Край до край криптиране**: Прилагане на сигурна комуникация във всички компоненти и потоци от данни
- **Валидация на входни данни**: Строга валидация на всички потребителски входове, API параметри и източници на данни

#### **Укрепване на инфраструктурата**
- **Многофакторно удостоверяване**: Задължително MFA за всички административни и служебни акаунти
- **Управление на пачове**: Автоматизирано и своевременно прилагане на пачове за операционни системи, рамки и зависимости  
- **Интеграция с доставчици на идентичност**: Централизирано управление на идентичности чрез корпоративни доставчици (Microsoft Entra ID, Active Directory)
- **Сегментация на мрежата**: Логическа изолация на MCP компоненти за ограничаване на страничното движение
- **Принцип на най-малко привилегии**: Минимални необходими разрешения за всички системни компоненти и акаунти

#### **Мониторинг и откриване на сигурността**
- **Всеобхватно логване**: Подробно логване на дейности в AI приложения, включително взаимодействия клиент-сървър на MCP
- **Интеграция със SIEM**: Централизирано управление на информация и събития за откриване на аномалии
- **Поведенческа аналитика**: AI-базирано наблюдение за откриване на необичайни модели в системното и потребителското поведение
- **Разузнаване за заплахи**: Интеграция на външни потоци с информация за заплахи и индикатори за компрометиране (IOC)
- **Реакция при инциденти**: Добре дефинирани процедури за откриване, реакция и възстановяване при инциденти със сигурността

#### **Архитектура с нулево доверие**
- **Никога не се доверявай, винаги проверявай**: Непрекъсната верификация на потребители, устройства и мрежови връзки
- **Микро-сегментация**: Гранулирани мрежови контроли, които изолират отделни натоварвания и услуги
- **Сигурност, базирана на идентичност**: Политики за сигурност, базирани на проверени идентичности, а не на мрежово местоположение
- **Непрекъсната оценка на риска**: Динамична оценка на сигурността според текущия контекст и поведение
- **Условен достъп**: Контроли на достъпа, които се адаптират според рискови фактори, местоположение и доверие към устройството

### Патерни за интеграция в предприятия

#### **Интеграция в екосистемата за сигурност на Microsoft**
- **Microsoft Defender for Cloud**: Всеобхватно управление на сигурността на облачната среда
- **Azure Sentinel**: Облачно роден SIEM и SOAR за защита на AI натоварвания
- **Microsoft Entra ID**: Управление на идентичности и достъп с политики за условен достъп
- **Azure Key Vault**: Централизирано управление на тайни с хардуерен модул за сигурност (HSM)
- **Microsoft Purview**: Управление на данни и съответствие за AI източници и работни потоци

#### **Съответствие и управление**
- **Регулаторно съответствие**: Уверете се, че реализации на MCP отговарят на специфични изисквания за съответствие (GDPR, HIPAA, SOC 2)
- **Класификация на данни**: Правилна категоризация и обработка на чувствителни данни, обработвани от AI системи
- **Одитни следи**: Всеобхватно логване за регулаторно съответствие и криминалистично разследване
- **Контроли за поверителност**: Прилагане на принципи за поверителност по дизайн в архитектурата на AI системите
- **Управление на промени**: Формални процеси за преглед на сигурността при модификации на AI системи

Тези основни практики създават стабилна база за сигурност, която подобрява ефективността на специфичните за MCP контроли и осигурява цялостна защита за AI-базирани приложения.

## Ключови изводи за сигурността

- **Многостепенен подход към сигурността**: Комбинирайте основни практики за сигурност (сигурно кодиране, най-малко привилегии, проверка на веригата за доставки, непрекъснат мониторинг) с AI-специфични контроли за цялостна защита

- **AI-специфичен пейзаж на заплахите**: MCP системите са изложени на уникални рискове, включително инжектиране на подсказки, отравяне на инструменти, отвличане на сесии, проблеми с объркания заместник, уязвимости при пропускане на токени и прекомерни разрешения, които изискват специализирани мерки

- **Отлично удостоверяване и упълномощаване**: Прилагайте стабилно удостоверяване чрез външни доставчици на идентичност (Microsoft Entra ID), налагайте правилна валидация на токени и никога не приемайте токени, които не са изрично издадени за вашия MCP сървър

- **Предотвратяване на AI атаки**: Внедрете Microsoft Prompt Shields и Azure Content Safety за защита срещу индиректно инжектиране на подсказки и отравяне на инструменти, като валидирате метаданни на инструменти и наблюдавате динамични промени

- **Сесийна и транспортна сигурност**: Използвайте криптографски сигурни, недетерминистични идентификатори на сесии, свързани с идентичности на потребители, прилагайте правилно управление на жизнения цикъл на сесията и никога не използвайте сесии за удостоверяване

- **Най-добри практики за OAuth сигурност**: Предотвратявайте атаки с объркан заместник чрез изрично съгласие на потребителя за динамично регистрирани клиенти, правилно прилагане на OAuth 2.1 с PKCE и стриктна валидация на URI за пренасочване  

- **Принципи за сигурност на токените**: Избягвайте анти-патърни при пропускане на токени, валидирайте претенциите за аудитория на токените, прилагайте краткоживотни токени с сигурна ротация и поддържайте ясни граници на доверие

- **Всеобхватна сигурност на веригата за доставки**: Отнасяйте се към всички компоненти на AI екосистемата (модели, вграждания, доставчици на контекст, външни API) със същата сигурност, както към традиционните софтуерни зависимости

- **Непрекъснато развитие**: Бъдете в крак с бързо развиващите се спецификации на MCP, допринасяйте за стандарти в общността за сигурност и поддържайте адаптивна сигурност с развитието на протокола

- **Интеграция със сигурността на Microsoft**: Използвайте цялостната екосистема за сигурност на Microsoft (Prompt Shields, Azure Content Safety, GitHub Advanced Security, Entra ID) за подобрена защита при внедряване на MCP

## Всеобхватни ресурси

### **Официална документация за сигурност на MCP**
- [MCP Спецификация (Текуща: 2025-11-25)](https://spec.modelcontextprotocol.io/specification/2025-11-25/)
- [Най-добри практики за сигурност на MCP](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)
- [Спецификация за упълномощаване на MCP](https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization)
- [MCP GitHub хранилище](https://github.com/modelcontextprotocol)

### **Стандарти и най-добри практики за сигурност**
- [Най-добри практики за сигурност на OAuth 2.0 (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [OWASP Top 10 за сигурност на уеб приложения](https://owasp.org/www-project-top-ten/)
- [OWASP Top 10 за големи езикови модели](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [Microsoft Digital Defense Report](https://aka.ms/mddr)

### **Изследвания и анализи за AI сигурност**
- [Инжектиране на подсказки в MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [Атаки с отравяне на инструменти (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [MCP Security Research Briefing (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)

### **Microsoft Security Solutions**
- [Документация за Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [Услуга за безопасност на съдържанието в Azure](https://learn.microsoft.com/azure/ai-services/content-safety/)
- [Сигурност на Microsoft Entra ID](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Най-добри практики за управление на токени в Azure](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [GitHub Advanced Security](https://github.com/security/advanced-security)

### **Ръководства за внедряване и уроци**
- [Azure API Management като MCP Authentication Gateway](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Удостоверяване на Microsoft Entra ID с MCP сървъри](https://den.dev/blog/mcp-server-auth-entra-id-session/)
- [Сигурно съхранение и криптиране на токени (Видео)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

### **DevOps и сигурност на веригата за доставки**
- [Сигурност в Azure DevOps](https://azure.microsoft.com/products/devops)
- [Сигурност в Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [Пътят към сигурността на веригата за доставки на Microsoft](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)

## **Допълнителна документация за сигурност**

За пълни указания за сигурност, вижте тези специализирани документи в този раздел:

- **[MCP Security Best Practices 2025](./mcp-security-best-practices-2025.md)** - Пълни най-добри практики за сигурност при внедряване на MCP
- **[Внедряване на Azure Content Safety](./azure-content-safety-implementation.md)** - Практически примери за интеграция на Azure Content Safety  
- **[MCP Security Controls 2025](./mcp-security-controls-2025.md)** - Най-нови контроли и техники за сигурност при MCP внедрявания
- **[MCP Best Practices Quick Reference](./mcp-best-practices.md)** - Бърз справочник за основни практики за сигурност на MCP

---

## Какво следва

Следва: [Глава 3: Започване](../03-GettingStarted/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**Отказ от отговорност**:  
Този документ е преведен с помощта на AI преводаческа услуга [Co-op Translator](https://github.com/Azure/co-op-translator). Въпреки че се стремим към точност, моля, имайте предвид, че автоматизираните преводи могат да съдържат грешки или неточности. Оригиналният документ на неговия роден език трябва да се счита за авторитетен източник. За критична информация се препоръчва професионален човешки превод. Ние не носим отговорност за каквито и да е недоразумения или неправилни тълкувания, произтичащи от използването на този превод.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->