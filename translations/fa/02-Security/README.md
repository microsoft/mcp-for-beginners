# امنیت MCP: حفاظت جامع برای سیستم‌های هوش مصنوعی

[![بهترین شیوه‌های امنیتی MCP](../../../translated_images/fa/03.175aed6dedae133f9d41e49cefd0f0a9a39c3317e1eaa7ef7182696af7534308.png)](https://youtu.be/88No8pw706o)

_(برای مشاهده ویدئوی این درس روی تصویر بالا کلیک کنید)_

امنیت اساس طراحی سیستم‌های هوش مصنوعی است، به همین دلیل ما آن را به عنوان بخش دوم خود اولویت می‌دهیم. این با اصل **امنیت بر اساس طراحی** مایکروسافت از [ابتکار آینده امن](https://www.microsoft.com/security/blog/2025/04/17/microsofts-secure-by-design-journey-one-year-of-success/) همسو است.

پروتکل زمینه مدل (MCP) قابلیت‌های قدرتمندی را به برنامه‌های مبتنی بر هوش مصنوعی می‌آورد و در عین حال چالش‌های امنیتی منحصر به فردی را معرفی می‌کند که فراتر از ریسک‌های سنتی نرم‌افزاری است. سیستم‌های MCP با نگرانی‌های امنیتی تثبیت‌شده (کدنویسی امن، حداقل امتیاز، امنیت زنجیره تأمین) و تهدیدات خاص هوش مصنوعی جدید از جمله تزریق پرامپت، مسمومیت ابزار، ربودن نشست، حملات نماینده گیج‌شده، آسیب‌پذیری‌های عبور توکن و تغییرات پویا در قابلیت‌ها مواجه هستند.

این درس مهم‌ترین ریسک‌های امنیتی در پیاده‌سازی‌های MCP را بررسی می‌کند—شامل احراز هویت، مجوزدهی، مجوزهای بیش از حد، تزریق پرامپت غیرمستقیم، امنیت نشست، مشکلات نماینده گیج‌شده، مدیریت توکن و آسیب‌پذیری‌های زنجیره تأمین. شما کنترل‌ها و بهترین شیوه‌های عملی برای کاهش این ریسک‌ها را خواهید آموخت و در عین حال از راه‌حل‌های مایکروسافت مانند سپرهای پرامپت، ایمنی محتوای Azure و امنیت پیشرفته GitHub برای تقویت استقرار MCP خود بهره خواهید برد.

## اهداف یادگیری

تا پایان این درس، شما قادر خواهید بود:

- **شناسایی تهدیدات خاص MCP**: ریسک‌های امنیتی منحصر به فرد در سیستم‌های MCP از جمله تزریق پرامپت، مسمومیت ابزار، مجوزهای بیش از حد، ربودن نشست، مشکلات نماینده گیج‌شده، آسیب‌پذیری‌های عبور توکن و ریسک‌های زنجیره تأمین را تشخیص دهید
- **اعمال کنترل‌های امنیتی**: کاهش‌های مؤثر شامل احراز هویت قوی، دسترسی حداقل امتیاز، مدیریت امن توکن، کنترل‌های امنیت نشست و تأیید زنجیره تأمین را پیاده‌سازی کنید
- **استفاده از راه‌حل‌های امنیتی مایکروسافت**: مایکروسافت Prompt Shields، Azure Content Safety و GitHub Advanced Security را برای حفاظت از بار کاری MCP درک و به کار ببرید
- **اعتبارسنجی امنیت ابزار**: اهمیت اعتبارسنجی متادیتای ابزار، نظارت بر تغییرات پویا و دفاع در برابر حملات تزریق پرامپت غیرمستقیم را بشناسید
- **ادغام بهترین شیوه‌ها**: اصول امنیتی تثبیت‌شده (کدنویسی امن، سخت‌سازی سرور، اعتماد صفر) را با کنترل‌های خاص MCP برای حفاظت جامع ترکیب کنید

# معماری و کنترل‌های امنیتی MCP

پیاده‌سازی‌های مدرن MCP نیازمند رویکردهای امنیتی چندلایه هستند که هم امنیت نرم‌افزار سنتی و هم تهدیدات خاص هوش مصنوعی را پوشش می‌دهند. مشخصات MCP که به سرعت در حال تکامل است، کنترل‌های امنیتی خود را بهبود می‌بخشد و امکان ادغام بهتر با معماری‌های امنیتی سازمانی و بهترین شیوه‌های تثبیت‌شده را فراهم می‌کند.

تحقیقات گزارش [Microsoft Digital Defense](https://aka.ms/mddr) نشان می‌دهد که **۹۸٪ از نفوذهای گزارش‌شده با رعایت بهداشت امنیتی قوی جلوگیری می‌شوند**. مؤثرترین استراتژی حفاظت ترکیبی از شیوه‌های امنیتی پایه با کنترل‌های خاص MCP است—اقدامات امنیتی پایه اثبات‌شده همچنان بیشترین تأثیر را در کاهش ریسک کلی امنیتی دارند.

## چشم‌انداز فعلی امنیت

> **توجه:** این اطلاعات استانداردهای امنیتی MCP را تا **۱۸ دسامبر ۲۰۲۵** منعکس می‌کند. پروتکل MCP به سرعت در حال تکامل است و پیاده‌سازی‌های آینده ممکن است الگوهای احراز هویت جدید و کنترل‌های پیشرفته‌تری معرفی کنند. همیشه به [مشخصات MCP](https://spec.modelcontextprotocol.io/)، [مخزن GitHub MCP](https://github.com/modelcontextprotocol) و [مستندات بهترین شیوه‌های امنیتی](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices) برای راهنمایی‌های به‌روز مراجعه کنید.

### تکامل احراز هویت MCP

مشخصات MCP در رویکرد خود به احراز هویت و مجوزدهی به طور قابل توجهی تکامل یافته است:

- **رویکرد اولیه**: مشخصات اولیه توسعه‌دهندگان را ملزم به پیاده‌سازی سرورهای احراز هویت سفارشی می‌کرد، در حالی که سرورهای MCP به عنوان سرورهای مجوزدهی OAuth 2.0 عمل می‌کردند و احراز هویت کاربران را مستقیماً مدیریت می‌کردند
- **استاندارد فعلی (۲۰۲۵-۱۱-۲۵)**: مشخصات به‌روزشده اجازه می‌دهد سرورهای MCP احراز هویت را به ارائه‌دهندگان هویت خارجی (مانند Microsoft Entra ID) واگذار کنند، که وضعیت امنیتی را بهبود می‌بخشد و پیچیدگی پیاده‌سازی را کاهش می‌دهد
- **امنیت لایه انتقال**: پشتیبانی بهبود یافته برای مکانیزم‌های انتقال امن با الگوهای احراز هویت مناسب برای اتصالات محلی (STDIO) و از راه دور (HTTP قابل جریان)

## امنیت احراز هویت و مجوزدهی

### چالش‌های امنیتی فعلی

پیاده‌سازی‌های مدرن MCP با چندین چالش احراز هویت و مجوزدهی مواجه هستند:

### ریسک‌ها و بردارهای تهدید

- **منطق مجوزدهی نادرست پیکربندی شده**: پیاده‌سازی معیوب مجوزدهی در سرورهای MCP می‌تواند داده‌های حساس را در معرض قرار دهد و کنترل‌های دسترسی را نادرست اعمال کند
- **نفوذ توکن OAuth**: سرقت توکن سرور MCP محلی به مهاجمان امکان می‌دهد خود را به جای سرورها جا بزنند و به خدمات پایین‌دستی دسترسی پیدا کنند
- **آسیب‌پذیری‌های عبور توکن**: مدیریت نادرست توکن باعث ایجاد دورزدن کنترل‌های امنیتی و شکاف‌های پاسخگویی می‌شود
- **مجوزهای بیش از حد**: سرورهای MCP با امتیازات بیش از حد اصول حداقل امتیاز را نقض می‌کنند و سطح حمله را گسترش می‌دهند

#### عبور توکن: یک ضدالگوی بحرانی

**عبور توکن به صراحت در مشخصات مجوزدهی MCP فعلی ممنوع است** به دلیل پیامدهای شدید امنیتی:

##### دورزدن کنترل‌های امنیتی
- سرورهای MCP و APIهای پایین‌دستی کنترل‌های امنیتی حیاتی (محدودیت نرخ، اعتبارسنجی درخواست، نظارت بر ترافیک) را پیاده‌سازی می‌کنند که به اعتبارسنجی صحیح توکن وابسته‌اند
- استفاده مستقیم کلاینت از توکن API این محافظت‌های اساسی را دور می‌زند و معماری امنیتی را تضعیف می‌کند

##### چالش‌های پاسخگویی و حسابرسی  
- سرورهای MCP نمی‌توانند بین کلاینت‌هایی که از توکن‌های صادرشده بالا دستی استفاده می‌کنند تمایز قائل شوند و مسیرهای حسابرسی را می‌شکنند
- لاگ‌های سرور منابع پایین‌دستی مبدا درخواست‌ها را به اشتباه نشان می‌دهند و نه واسطه‌های واقعی سرور MCP
- بررسی حادثه و حسابرسی انطباق به طور قابل توجهی دشوار می‌شود

##### ریسک‌های استخراج داده
- ادعاهای توکن تأییدنشده به بازیگران مخرب با توکن‌های سرقت‌شده اجازه می‌دهد از سرورهای MCP به عنوان پروکسی برای استخراج داده استفاده کنند
- نقض مرز اعتماد الگوهای دسترسی غیرمجاز را ایجاد می‌کند که کنترل‌های امنیتی مورد نظر را دور می‌زند

##### بردارهای حمله چندسرویسی
- توکن‌های به خطر افتاده که توسط چندین سرویس پذیرفته می‌شوند امکان حرکت جانبی در سیستم‌های متصل را فراهم می‌کنند
- فرضیات اعتماد بین سرویس‌ها ممکن است زمانی که مبدا توکن‌ها قابل تأیید نباشد نقض شود

### کنترل‌ها و کاهش‌های امنیتی

**الزامات امنیتی حیاتی:**

> **الزامی**: سرورهای MCP **نباید** هیچ توکنی را که به صراحت برای سرور MCP صادر نشده است قبول کنند

#### کنترل‌های احراز هویت و مجوزدهی

- **بازبینی دقیق مجوزدهی**: ممیزی‌های جامع منطق مجوزدهی سرور MCP را انجام دهید تا اطمینان حاصل شود که فقط کاربران و کلاینت‌های مورد نظر به منابع حساس دسترسی دارند
  - **راهنمای پیاده‌سازی**: [مدیریت API Azure به عنوان دروازه احراز هویت برای سرورهای MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
  - **ادغام هویت**: [استفاده از Microsoft Entra ID برای احراز هویت سرور MCP](https://den.dev/blog/mcp-server-auth-entra-id-session/)

- **مدیریت امن توکن**: بهترین شیوه‌های اعتبارسنجی و چرخه عمر توکن مایکروسافت را پیاده‌سازی کنید ([لینک](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens))
  - اعتبارسنجی ادعاهای مخاطب توکن که با هویت سرور MCP مطابقت دارد
  - اجرای سیاست‌های مناسب چرخش و انقضای توکن
  - جلوگیری از حملات تکرار توکن و استفاده غیرمجاز

- **ذخیره‌سازی محافظت‌شده توکن**: ذخیره‌سازی توکن با رمزنگاری در حالت استراحت و انتقال
  - **بهترین شیوه‌ها**: [راهنمای ذخیره‌سازی و رمزنگاری امن توکن](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

#### پیاده‌سازی کنترل دسترسی

- **اصل حداقل امتیاز**: فقط حداقل مجوزهای لازم برای عملکرد مورد نظر به سرورهای MCP اعطا شود
  - بازبینی و به‌روزرسانی منظم مجوزها برای جلوگیری از افزایش امتیاز
  - **مستندات مایکروسافت**: [دسترسی امن با حداقل امتیاز](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)

- **کنترل دسترسی مبتنی بر نقش (RBAC)**: تخصیص نقش‌های دقیق
  - محدود کردن نقش‌ها به منابع و اقدامات خاص
  - اجتناب از مجوزهای گسترده یا غیرضروری که سطح حمله را افزایش می‌دهند

- **نظارت مداوم بر مجوزها**: حسابرسی و نظارت مداوم بر دسترسی
  - نظارت بر الگوهای استفاده از مجوز برای شناسایی ناهنجاری‌ها
  - اصلاح سریع مجوزهای بیش از حد یا استفاده نشده

## تهدیدات امنیتی خاص هوش مصنوعی

### حملات تزریق پرامپت و دستکاری ابزار

پیاده‌سازی‌های مدرن MCP با بردارهای حمله پیچیده خاص هوش مصنوعی مواجه هستند که اقدامات امنیتی سنتی نمی‌توانند به طور کامل آنها را پوشش دهند:

#### **تزریق پرامپت غیرمستقیم (تزریق پرامپت بین‌دامنه)**

**تزریق پرامپت غیرمستقیم** یکی از بحرانی‌ترین آسیب‌پذیری‌ها در سیستم‌های هوش مصنوعی فعال‌شده با MCP است. مهاجمان دستورالعمل‌های مخرب را در محتوای خارجی—اسناد، صفحات وب، ایمیل‌ها یا منابع داده—قرار می‌دهند که سیستم‌های هوش مصنوعی بعداً به عنوان دستورات معتبر پردازش می‌کنند.

**سناریوهای حمله:**
- **تزریق مبتنی بر سند**: دستورالعمل‌های مخرب پنهان در اسناد پردازش‌شده که باعث اقدامات ناخواسته هوش مصنوعی می‌شوند
- **سوءاستفاده از محتوای وب**: صفحات وب به خطر افتاده حاوی پرامپت‌های جاسازی‌شده که رفتار هوش مصنوعی را هنگام استخراج داده دستکاری می‌کنند
- **حملات مبتنی بر ایمیل**: پرامپت‌های مخرب در ایمیل‌ها که باعث نشت اطلاعات یا انجام اقدامات غیرمجاز توسط دستیارهای هوش مصنوعی می‌شوند
- **آلودگی منابع داده**: پایگاه‌های داده یا APIهای به خطر افتاده که محتوای آلوده به سیستم‌های هوش مصنوعی ارائه می‌دهند

**تأثیر دنیای واقعی**: این حملات می‌توانند منجر به استخراج داده، نقض حریم خصوصی، تولید محتوای مضر و دستکاری تعاملات کاربر شوند. برای تحلیل دقیق‌تر، به [تزریق پرامپت در MCP (سایمون ویلیسون)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/) مراجعه کنید.

![نمودار حمله تزریق پرامپت](../../../translated_images/fa/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.png)

#### **حملات مسمومیت ابزار**

**مسمومیت ابزار** متادیتایی را هدف قرار می‌دهد که ابزارهای MCP را تعریف می‌کند و از نحوه تفسیر توصیفات و پارامترهای ابزار توسط مدل‌های زبان بزرگ برای تصمیم‌گیری در اجرای دستورات سوءاستفاده می‌کند.

**مکانیزم‌های حمله:**
- **دستکاری متادیتا**: مهاجمان دستورالعمل‌های مخرب را در توصیفات ابزار، تعاریف پارامتر یا مثال‌های استفاده تزریق می‌کنند
- **دستورالعمل‌های نامرئی**: پرامپت‌های پنهان در متادیتای ابزار که توسط مدل‌های هوش مصنوعی پردازش می‌شوند اما برای کاربران انسانی نامرئی هستند
- **تغییرات پویا در ابزار ("کشیدن فرش")**: ابزارهایی که توسط کاربران تأیید شده‌اند بعداً بدون اطلاع کاربر برای انجام اقدامات مخرب تغییر می‌کنند
- **تزریق پارامتر**: محتوای مخرب جاسازی‌شده در طرح‌های پارامتر ابزار که رفتار مدل را تحت تأثیر قرار می‌دهد

**ریسک‌های سرور میزبانی‌شده**: سرورهای MCP از راه دور ریسک‌های بالاتری دارند زیرا تعاریف ابزار می‌توانند پس از تأیید اولیه کاربر به‌روزرسانی شوند و سناریوهایی ایجاد کنند که ابزارهای قبلاً ایمن به مخرب تبدیل شوند. برای تحلیل جامع، به [حملات مسمومیت ابزار (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks) مراجعه کنید.

![نمودار حمله تزریق ابزار](../../../translated_images/fa/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.png)

#### **بردارهای حمله اضافی هوش مصنوعی**

- **تزریق پرامپت بین‌دامنه (XPIA)**: حملات پیچیده‌ای که از محتوای چندین دامنه برای دور زدن کنترل‌های امنیتی استفاده می‌کنند
- **تغییرات پویا در قابلیت‌ها**: تغییرات زمان واقعی در قابلیت‌های ابزار که از ارزیابی‌های امنیتی اولیه فرار می‌کنند
- **مسمومیت پنجره زمینه**: حملاتی که پنجره‌های زمینه بزرگ را دستکاری می‌کنند تا دستورالعمل‌های مخرب را پنهان کنند
- **حملات سردرگمی مدل**: سوءاستفاده از محدودیت‌های مدل برای ایجاد رفتارهای غیرقابل پیش‌بینی یا ناامن

### تأثیر ریسک امنیتی هوش مصنوعی

**پیامدهای با تأثیر بالا:**
- **استخراج داده**: دسترسی غیرمجاز و سرقت داده‌های حساس سازمانی یا شخصی
- **نقض حریم خصوصی**: افشای اطلاعات شناسایی شخصی (PII) و داده‌های محرمانه کسب‌وکار  
- **دستکاری سیستم**: تغییرات ناخواسته در سیستم‌ها و جریان‌های کاری حیاتی
- **سرقت اعتبارنامه**: به خطر افتادن توکن‌های احراز هویت و اعتبارنامه‌های سرویس
- **حرکت جانبی**: استفاده از سیستم‌های هوش مصنوعی به خطر افتاده به عنوان نقطه شروع برای حملات گسترده‌تر شبکه

### راه‌حل‌های امنیتی هوش مصنوعی مایکروسافت

#### **سپرهای پرامپت هوش مصنوعی: حفاظت پیشرفته در برابر حملات تزریق**

مایکروسافت **سپرهای پرامپت هوش مصنوعی** دفاع جامعی در برابر حملات تزریق پرامپت مستقیم و غیرمستقیم از طریق چندین لایه امنیتی فراهم می‌کند:

##### **مکانیزم‌های اصلی حفاظت:**

1. **شناسایی و فیلترینگ پیشرفته**
   - الگوریتم‌های یادگیری ماشین و تکنیک‌های پردازش زبان طبیعی دستورالعمل‌های مخرب در محتوای خارجی را شناسایی می‌کنند
   - تحلیل بلادرنگ اسناد، صفحات وب، ایمیل‌ها و منابع داده برای تهدیدهای جاسازی‌شده
   - درک زمینه‌ای الگوهای پرامپت معتبر در مقابل مخرب

2. **تکنیک‌های برجسته‌سازی**  
   - تمایز بین دستورالعمل‌های سیستم مورد اعتماد و ورودی‌های خارجی احتمالا به خطر افتاده
   - روش‌های تبدیل متن که مرتبط بودن مدل را افزایش می‌دهند و در عین حال محتوای مخرب را جدا می‌کنند
   - کمک به سیستم‌های هوش مصنوعی برای حفظ سلسله‌مراتب دستورات صحیح و نادیده گرفتن دستورات تزریق‌شده

3. **سیستم‌های جداکننده و علامت‌گذاری داده**
   - تعریف مرز صریح بین پیام‌های سیستم مورد اعتماد و متن ورودی خارجی
   - نشانگرهای ویژه که مرز بین منابع داده مورد اعتماد و غیرمورد اعتماد را برجسته می‌کنند
   - جداسازی واضح که از سردرگمی دستورالعمل و اجرای غیرمجاز فرمان جلوگیری می‌کند

4. **اطلاعات تهدید مداوم**
   - مایکروسافت به طور مداوم الگوهای حمله نوظهور را رصد و دفاع‌ها را به‌روزرسانی می‌کند
   - شکار تهدید پیشگیرانه برای تکنیک‌ها و بردارهای حمله جدید تزریق
   - به‌روزرسانی‌های منظم مدل امنیتی برای حفظ اثربخشی در برابر تهدیدات در حال تکامل

5. **ادغام ایمنی محتوای Azure**
   - بخشی از مجموعه جامع ایمنی محتوای Azure AI
   - شناسایی اضافی برای تلاش‌های فرار از محدودیت، محتوای مضر و نقض سیاست‌های امنیتی
   - کنترل‌های امنیتی یکپارچه در سراسر اجزای برنامه هوش مصنوعی

**منابع پیاده‌سازی**: [مستندات Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)

![حفاظت Microsoft Prompt Shields](../../../translated_images/fa/prompt-shield.ff5b95be76e9c78c6ec0888206a4a6a0a5ab4bb787832a9eceef7a62fe0138d1.png)


## تهدیدات پیشرفته امنیتی MCP

### آسیب‌پذیری‌های ربودن نشست

**ربودن نشست** یک بردار حمله بحرانی در پیاده‌سازی‌های حالت‌دار MCP است که در آن طرف‌های غیرمجاز شناسه‌های نشست معتبر را به دست می‌آورند و سوءاستفاده می‌کنند تا خود را به جای کلاینت‌ها جا بزنند و اقدامات غیرمجاز انجام دهند.

#### **سناریوها و ریسک‌های حمله**

- **تزریق پرامپت ربودن نشست**: مهاجمان با شناسه‌های نشست سرقت‌شده رویدادهای مخرب را به سرورهایی که حالت نشست را به اشتراک می‌گذارند تزریق می‌کنند، که ممکن است باعث اقدامات مضر یا دسترسی به داده‌های حساس شود
- **جعل هویت مستقیم**: شناسه‌های نشست سرقت‌شده امکان فراخوانی مستقیم سرور MCP را بدون احراز هویت فراهم می‌کنند و مهاجمان را به عنوان کاربران معتبر می‌شناسند
- **جریان‌های قابل ازسرگیری به خطر افتاده**: مهاجمان می‌توانند درخواست‌ها را زودتر از موعد خاتمه دهند و باعث شوند کلاینت‌های معتبر با محتوای احتمالا مخرب ادامه دهند

#### **کنترل‌های امنیتی برای مدیریت نشست**

**الزامات حیاتی:**
- **تأیید مجوز**: سرورهای MCP که مجوز را پیاده‌سازی می‌کنند **باید** تمام درخواست‌های ورودی را تأیید کنند و **نباید** برای احراز هویت به نشست‌ها تکیه کنند  
- **تولید نشست امن**: استفاده از شناسه‌های نشست غیرقطعی و رمزنگاری شده که با تولیدکننده‌های عدد تصادفی امن ساخته شده‌اند  
- **اتصال اختصاصی به کاربر**: اتصال شناسه‌های نشست به اطلاعات اختصاصی کاربر با فرمت‌هایی مانند `<user_id>:<session_id>` برای جلوگیری از سوءاستفاده نشست بین کاربران  
- **مدیریت چرخه عمر نشست**: پیاده‌سازی انقضا، چرخش و ابطال مناسب برای محدود کردن پنجره‌های آسیب‌پذیری  
- **امنیت انتقال**: استفاده اجباری از HTTPS برای تمام ارتباطات جهت جلوگیری از رهگیری شناسه نشست  

### مشکل نماینده گیج‌شده

**مشکل نماینده گیج‌شده** زمانی رخ می‌دهد که سرورهای MCP به عنوان پروکسی احراز هویت بین مشتریان و سرویس‌های شخص ثالث عمل می‌کنند و فرصت‌هایی برای دور زدن مجوز از طریق سوءاستفاده از شناسه‌های مشتری ثابت ایجاد می‌کنند.

#### **مکانیزم‌ها و ریسک‌های حمله**

- **دور زدن رضایت مبتنی بر کوکی**: احراز هویت قبلی کاربر کوکی‌های رضایت ایجاد می‌کند که مهاجمان از طریق درخواست‌های مجوز مخرب با URIهای بازگشتی دستکاری شده سوءاستفاده می‌کنند  
- **سرقت کد مجوز**: کوکی‌های رضایت موجود ممکن است باعث شود سرورهای مجوز صفحه‌های رضایت را رد کنند و کدها را به نقاط انتهایی تحت کنترل مهاجم هدایت کنند  
- **دسترسی غیرمجاز به API**: کدهای مجوز سرقت شده امکان تبادل توکن و جعل هویت کاربر بدون تأیید صریح را فراهم می‌کنند  

#### **راهبردهای کاهش خطر**

**کنترل‌های اجباری:**  
- **الزامات رضایت صریح**: سرورهای پروکسی MCP که از شناسه‌های مشتری ثابت استفاده می‌کنند **باید** برای هر مشتری ثبت‌شده پویا رضایت کاربر را دریافت کنند  
- **پیاده‌سازی امنیت OAuth 2.1**: پیروی از بهترین شیوه‌های امنیتی فعلی OAuth شامل PKCE (اثبات کلید برای تبادل کد) برای تمام درخواست‌های مجوز  
- **اعتبارسنجی سختگیرانه مشتری**: پیاده‌سازی اعتبارسنجی دقیق URIهای بازگشتی و شناسه‌های مشتری برای جلوگیری از سوءاستفاده  

### آسیب‌پذیری‌های عبور توکن  

**عبور توکن** یک الگوی ضد صریح است که در آن سرورهای MCP توکن‌های مشتری را بدون اعتبارسنجی مناسب می‌پذیرند و آنها را به APIهای پایین‌دستی ارسال می‌کنند که این نقض مشخصات مجوز MCP است.

#### **پیامدهای امنیتی**

- **دور زدن کنترل‌ها**: استفاده مستقیم توکن از مشتری به API کنترل‌های مهم محدودیت نرخ، اعتبارسنجی و نظارت را دور می‌زند  
- **خرابی ردپای حسابرسی**: توکن‌های صادر شده از بالا امکان شناسایی مشتری را غیرممکن می‌کنند و قابلیت بررسی حادثه را مختل می‌سازند  
- **خروج داده از طریق پروکسی**: توکن‌های بدون اعتبارسنجی به بازیگران مخرب اجازه می‌دهند از سرورها به عنوان پروکسی برای دسترسی غیرمجاز به داده‌ها استفاده کنند  
- **نقض مرز اعتماد**: فرضیات اعتماد سرویس‌های پایین‌دستی ممکن است زمانی که منشاء توکن قابل تأیید نباشد نقض شود  
- **گسترش حمله چندسرویسی**: توکن‌های به خطر افتاده که در چندین سرویس پذیرفته می‌شوند امکان حرکت جانبی را فراهم می‌کنند  

#### **کنترل‌های امنیتی مورد نیاز**

**الزامات غیرقابل مذاکره:**  
- **اعتبارسنجی توکن**: سرورهای MCP **نباید** توکن‌هایی را بپذیرند که صراحتاً برای سرور MCP صادر نشده‌اند  
- **تأیید مخاطب**: همیشه ادعاهای مخاطب توکن را با هویت سرور MCP تطبیق دهید  
- **چرخه عمر مناسب توکن**: پیاده‌سازی توکن‌های دسترسی کوتاه‌مدت با شیوه‌های چرخش امن  

## امنیت زنجیره تأمین برای سیستم‌های هوش مصنوعی

امنیت زنجیره تأمین فراتر از وابستگی‌های نرم‌افزاری سنتی توسعه یافته و کل اکوسیستم هوش مصنوعی را در بر می‌گیرد. پیاده‌سازی‌های مدرن MCP باید تمام اجزای مرتبط با هوش مصنوعی را به دقت تأیید و نظارت کنند، زیرا هر کدام می‌توانند آسیب‌پذیری‌هایی ایجاد کنند که یکپارچگی سیستم را به خطر می‌اندازند.

### اجزای گسترش یافته زنجیره تأمین هوش مصنوعی

**وابستگی‌های نرم‌افزاری سنتی:**  
- کتابخانه‌ها و چارچوب‌های متن‌باز  
- تصاویر کانتینر و سیستم‌های پایه  
- ابزارهای توسعه و خطوط ساخت  
- اجزا و خدمات زیرساختی  

**عناصر زنجیره تأمین خاص هوش مصنوعی:**  
- **مدل‌های پایه**: مدل‌های پیش‌آموزش دیده از ارائه‌دهندگان مختلف که نیاز به تأیید اصالت دارند  
- **خدمات جاسازی**: خدمات بردارسازی و جستجوی معنایی خارجی  
- **تأمین‌کنندگان زمینه**: منابع داده، پایگاه‌های دانش و مخازن اسناد  
- **APIهای شخص ثالث**: خدمات هوش مصنوعی خارجی، خطوط لوله یادگیری ماشین و نقاط انتهایی پردازش داده  
- **آثار مدل**: وزن‌ها، پیکربندی‌ها و نسخه‌های مدل تنظیم‌شده  
- **منابع داده آموزشی**: مجموعه داده‌های استفاده شده برای آموزش و تنظیم مدل  

### استراتژی جامع امنیت زنجیره تأمین

#### **تأیید و اعتماد به اجزا**  
- **اعتبارسنجی اصالت**: تأیید منشاء، مجوز و یکپارچگی تمام اجزای هوش مصنوعی قبل از ادغام  
- **ارزیابی امنیتی**: انجام اسکن آسیب‌پذیری و بررسی‌های امنیتی برای مدل‌ها، منابع داده و خدمات هوش مصنوعی  
- **تحلیل شهرت**: ارزیابی سابقه امنیتی و شیوه‌های ارائه‌دهندگان خدمات هوش مصنوعی  
- **تأیید انطباق**: اطمینان از اینکه تمام اجزا با الزامات امنیتی و مقررات سازمانی مطابقت دارند  

#### **خطوط لوله استقرار امن**  
- **امنیت CI/CD خودکار**: ادغام اسکن امنیتی در سراسر خطوط لوله استقرار خودکار  
- **یکپارچگی آثار**: پیاده‌سازی تأیید رمزنگاری برای تمام آثار مستقر شده (کد، مدل‌ها، پیکربندی‌ها)  
- **استقرار مرحله‌ای**: استفاده از استراتژی‌های استقرار تدریجی با اعتبارسنجی امنیتی در هر مرحله  
- **مخازن آثار مورد اعتماد**: استقرار فقط از مخازن و رجیستری‌های آثار تأیید شده و امن  

#### **نظارت و پاسخ مستمر**  
- **اسکن وابستگی‌ها**: نظارت مداوم آسیب‌پذیری برای تمام وابستگی‌های نرم‌افزاری و اجزای هوش مصنوعی  
- **نظارت مدل**: ارزیابی مستمر رفتار مدل، انحراف عملکرد و ناهنجاری‌های امنیتی  
- **ردیابی سلامت سرویس**: نظارت بر خدمات هوش مصنوعی خارجی برای در دسترس بودن، حوادث امنیتی و تغییرات سیاست  
- **ادغام اطلاعات تهدید**: وارد کردن خوراک‌های تهدید خاص به ریسک‌های امنیتی هوش مصنوعی و یادگیری ماشین  

#### **کنترل دسترسی و حداقل امتیاز**  
- **مجوزهای سطح جزء**: محدود کردن دسترسی به مدل‌ها، داده‌ها و خدمات بر اساس ضرورت کسب‌وکار  
- **مدیریت حساب‌های سرویس**: پیاده‌سازی حساب‌های سرویس اختصاصی با حداقل مجوزهای لازم  
- **تقسیم‌بندی شبکه**: جداسازی اجزای هوش مصنوعی و محدود کردن دسترسی شبکه بین خدمات  
- **کنترل‌های دروازه API**: استفاده از دروازه‌های API متمرکز برای کنترل و نظارت بر دسترسی به خدمات هوش مصنوعی خارجی  

#### **پاسخ به حادثه و بازیابی**  
- **روش‌های پاسخ سریع**: فرآیندهای تثبیت شده برای وصله‌کردن یا جایگزینی اجزای هوش مصنوعی به خطر افتاده  
- **چرخش اعتبارنامه‌ها**: سیستم‌های خودکار برای چرخش اسرار، کلیدهای API و اعتبارنامه‌های سرویس  
- **قابلیت بازگشت**: توانایی بازگرداندن سریع به نسخه‌های قبلی شناخته شده و سالم اجزای هوش مصنوعی  
- **بازیابی از نفوذ زنجیره تأمین**: روش‌های خاص برای پاسخ به نفوذ در خدمات هوش مصنوعی بالا دستی  

### ابزارها و ادغام امنیتی مایکروسافت

**GitHub Advanced Security** حفاظت جامع زنجیره تأمین را ارائه می‌دهد که شامل:  
- **اسکن اسرار**: شناسایی خودکار اعتبارنامه‌ها، کلیدهای API و توکن‌ها در مخازن  
- **اسکن وابستگی‌ها**: ارزیابی آسیب‌پذیری برای وابستگی‌ها و کتابخانه‌های متن‌باز  
- **تحلیل CodeQL**: تحلیل کد ایستا برای آسیب‌پذیری‌های امنیتی و مشکلات کدنویسی  
- **بینش‌های زنجیره تأمین**: دید به سلامت وابستگی‌ها و وضعیت امنیتی  

**ادغام Azure DevOps و Azure Repos:**  
- ادغام بی‌وقفه اسکن امنیتی در سراسر پلتفرم‌های توسعه مایکروسافت  
- بررسی‌های امنیتی خودکار در Azure Pipelines برای بارهای کاری هوش مصنوعی  
- اجرای سیاست برای استقرار امن اجزای هوش مصنوعی  

**شیوه‌های داخلی مایکروسافت:**  
مایکروسافت شیوه‌های گسترده امنیت زنجیره تأمین را در تمام محصولات اجرا می‌کند. درباره رویکردهای اثبات شده در [سفر به سوی تأمین امنیت زنجیره تأمین نرم‌افزار در مایکروسافت](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/) بیشتر بدانید.  

## بهترین شیوه‌های امنیتی پایه

پیاده‌سازی‌های MCP از وضعیت امنیتی موجود سازمان شما ارث می‌برند و بر آن بنا می‌کنند. تقویت شیوه‌های امنیتی پایه به طور قابل توجهی امنیت کلی سیستم‌های هوش مصنوعی و استقرارهای MCP را افزایش می‌دهد.

### اصول امنیتی پایه

#### **شیوه‌های توسعه امن**  
- **انطباق با OWASP**: محافظت در برابر آسیب‌پذیری‌های وب برنامه‌های کاربردی [OWASP Top 10](https://owasp.org/www-project-top-ten/)  
- **محافظت‌های خاص هوش مصنوعی**: پیاده‌سازی کنترل‌ها برای [OWASP Top 10 برای مدل‌های زبان بزرگ](https://genai.owasp.org/download/43299/?tmstv=1731900559)  
- **مدیریت امن اسرار**: استفاده از خزانه‌های اختصاصی برای توکن‌ها، کلیدهای API و داده‌های پیکربندی حساس  
- **رمزنگاری انتها به انتها**: پیاده‌سازی ارتباطات امن در تمام اجزا و جریان‌های داده برنامه  
- **اعتبارسنجی ورودی**: اعتبارسنجی دقیق تمام ورودی‌های کاربر، پارامترهای API و منابع داده  

#### **سخت‌سازی زیرساخت**  
- **احراز هویت چندعاملی**: MFA اجباری برای تمام حساب‌های مدیریتی و سرویس  
- **مدیریت وصله‌ها**: وصله‌کردن خودکار و به موقع سیستم‌عامل‌ها، چارچوب‌ها و وابستگی‌ها  
- **ادغام ارائه‌دهنده هویت**: مدیریت هویت متمرکز از طریق ارائه‌دهندگان هویت سازمانی (Microsoft Entra ID، Active Directory)  
- **تقسیم‌بندی شبکه**: جداسازی منطقی اجزای MCP برای محدود کردن حرکت جانبی  
- **اصل حداقل امتیاز**: حداقل مجوزهای لازم برای تمام اجزا و حساب‌های سیستم  

#### **نظارت و کشف امنیتی**  
- **ثبت جامع**: ثبت دقیق فعالیت‌های برنامه هوش مصنوعی، شامل تعاملات مشتری-سرور MCP  
- **ادغام SIEM**: مدیریت متمرکز اطلاعات و رویدادهای امنیتی برای کشف ناهنجاری‌ها  
- **تحلیل رفتاری**: نظارت مبتنی بر هوش مصنوعی برای شناسایی الگوهای غیرمعمول در رفتار سیستم و کاربر  
- **اطلاعات تهدید**: ادغام خوراک‌های تهدید خارجی و شاخص‌های نفوذ (IOC)  
- **پاسخ به حادثه**: فرآیندهای تعریف شده برای کشف، پاسخ و بازیابی از حوادث امنیتی  

#### **معماری اعتماد صفر**  
- **هرگز اعتماد نکن، همیشه تأیید کن**: تأیید مستمر کاربران، دستگاه‌ها و اتصالات شبکه  
- **ریزتقسیم‌بندی**: کنترل‌های شبکه دقیق که بارهای کاری و خدمات فردی را جدا می‌کند  
- **امنیت مبتنی بر هویت**: سیاست‌های امنیتی مبتنی بر هویت‌های تأیید شده به جای موقعیت شبکه  
- **ارزیابی ریسک مستمر**: ارزیابی پویا وضعیت امنیتی بر اساس زمینه و رفتار فعلی  
- **دسترسی مشروط**: کنترل‌های دسترسی که بر اساس عوامل ریسک، موقعیت و اعتماد دستگاه تطبیق می‌یابند  

### الگوهای ادغام سازمانی

#### **ادغام اکوسیستم امنیتی مایکروسافت**  
- **Microsoft Defender for Cloud**: مدیریت جامع وضعیت امنیتی ابر  
- **Azure Sentinel**: قابلیت‌های بومی ابر SIEM و SOAR برای حفاظت از بارهای کاری هوش مصنوعی  
- **Microsoft Entra ID**: مدیریت هویت و دسترسی سازمانی با سیاست‌های دسترسی مشروط  
- **Azure Key Vault**: مدیریت متمرکز اسرار با پشتیبانی ماژول امنیت سخت‌افزاری (HSM)  
- **Microsoft Purview**: حاکمیت داده و انطباق برای منابع داده و جریان‌های کاری هوش مصنوعی  

#### **انطباق و حاکمیت**  
- **همسویی با مقررات**: اطمینان از اینکه پیاده‌سازی‌های MCP الزامات انطباق صنعت را برآورده می‌کنند (GDPR، HIPAA، SOC 2)  
- **طبقه‌بندی داده‌ها**: دسته‌بندی و مدیریت مناسب داده‌های حساس پردازش شده توسط سیستم‌های هوش مصنوعی  
- **ردپای حسابرسی**: ثبت جامع برای انطباق مقررات و تحقیقات قضایی  
- **کنترل‌های حریم خصوصی**: پیاده‌سازی اصول حفظ حریم خصوصی در طراحی معماری سیستم هوش مصنوعی  
- **مدیریت تغییر**: فرآیندهای رسمی برای بررسی‌های امنیتی تغییرات سیستم هوش مصنوعی  

این شیوه‌های پایه یک خط مبنای امنیتی قوی ایجاد می‌کنند که اثربخشی کنترل‌های امنیتی خاص MCP را افزایش داده و حفاظت جامع برای برنامه‌های مبتنی بر هوش مصنوعی فراهم می‌آورد.  

## نکات کلیدی امنیتی

- **رویکرد امنیتی چندلایه**: ترکیب شیوه‌های امنیتی پایه (کدنویسی امن، حداقل امتیاز، تأیید زنجیره تأمین، نظارت مستمر) با کنترل‌های خاص هوش مصنوعی برای حفاظت جامع  

- **چشم‌انداز تهدید خاص هوش مصنوعی**: سیستم‌های MCP با ریسک‌های منحصر به فردی مانند تزریق درخواست، مسمومیت ابزار، ربودن نشست، مشکل نماینده گیج‌شده، آسیب‌پذیری‌های عبور توکن و مجوزهای بیش از حد مواجه‌اند که نیازمند کاهش‌های تخصصی هستند  

- **برتری احراز هویت و مجوز**: پیاده‌سازی احراز هویت قوی با استفاده از ارائه‌دهندگان هویت خارجی (Microsoft Entra ID)، اجرای اعتبارسنجی صحیح توکن و هرگز پذیرش توکن‌هایی که صراحتاً برای سرور MCP شما صادر نشده‌اند  

- **پیشگیری از حملات هوش مصنوعی**: استقرار Microsoft Prompt Shields و Azure Content Safety برای دفاع در برابر تزریق غیرمستقیم درخواست و حملات مسمومیت ابزار، همراه با اعتبارسنجی متادیتای ابزار و نظارت بر تغییرات پویا  

- **امنیت نشست و انتقال**: استفاده از شناسه‌های نشست رمزنگاری شده، غیرقطعی و متصل به هویت کاربر، پیاده‌سازی مدیریت چرخه عمر نشست مناسب و هرگز استفاده از نشست‌ها برای احراز هویت  

- **بهترین شیوه‌های امنیت OAuth**: جلوگیری از حملات نماینده گیج‌شده از طریق رضایت صریح کاربر برای مشتریان ثبت‌شده پویا، پیاده‌سازی صحیح OAuth 2.1 با PKCE و اعتبارسنجی سختگیرانه URI بازگشتی  

- **اصول امنیت توکن**: اجتناب از الگوی ضد عبور توکن، اعتبارسنجی ادعاهای مخاطب توکن، پیاده‌سازی توکن‌های کوتاه‌مدت با چرخش امن و حفظ مرزهای اعتماد واضح  

- **امنیت جامع زنجیره تأمین**: برخورد با تمام اجزای اکوسیستم هوش مصنوعی (مدل‌ها، جاسازی‌ها، تأمین‌کنندگان زمینه، APIهای خارجی) با همان دقت امنیتی وابستگی‌های نرم‌افزاری سنتی  

- **تکامل مستمر**: به‌روز ماندن با مشخصات MCP که به سرعت در حال تحول است، مشارکت در استانداردهای جامعه امنیتی و حفظ وضعیت امنیتی تطبیقی با پیشرفت پروتکل  

- **ادغام امنیتی مایکروسافت**: بهره‌گیری از اکوسیستم امنیتی جامع مایکروسافت (Prompt Shields، Azure Content Safety، GitHub Advanced Security، Entra ID) برای حفاظت بهتر استقرار MCP  

## منابع جامع

### **مستندات رسمی امنیت MCP**  
- [مشخصات MCP (فعلی: 2025-11-25)](https://spec.modelcontextprotocol.io/specification/2025-11-25/)  
- [بهترین شیوه‌های امنیتی MCP](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)  
- [مشخصات مجوز MCP](https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization)  
- [مخزن GitHub MCP](https://github.com/modelcontextprotocol)  

### **استانداردها و بهترین شیوه‌های امنیتی**  
- [بهترین شیوه‌های امنیت OAuth 2.0 (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)  
- [OWASP Top 10 امنیت برنامه‌های وب](https://owasp.org/www-project-top-ten/)  
- [OWASP Top 10 برای مدل‌های زبان بزرگ](https://genai.owasp.org/download/43299/?tmstv=1731900559)  
- [گزارش دفاع دیجیتال مایکروسافت](https://aka.ms/mddr)  

### **تحقیقات و تحلیل‌های امنیت هوش مصنوعی**  
- [تزریق درخواست در MCP (سایمون ویلیسون)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)  
- [حملات مسمومیت ابزار (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)  
- [گزارش تحقیق امنیتی MCP (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)

### **راه‌حل‌های امنیتی مایکروسافت**
- [مستندات محافظ‌های درخواست مایکروسافت](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [سرویس ایمنی محتوا Azure](https://learn.microsoft.com/azure/ai-services/content-safety/)
- [امنیت Microsoft Entra ID](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [بهترین شیوه‌های مدیریت توکن Azure](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [امنیت پیشرفته GitHub](https://github.com/security/advanced-security)

### **راهنماها و آموزش‌های پیاده‌سازی**
- [مدیریت API Azure به عنوان دروازه احراز هویت MCP](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [احراز هویت Microsoft Entra ID با سرورهای MCP](https://den.dev/blog/mcp-server-auth-entra-id-session/)
- [ذخیره و رمزنگاری امن توکن (ویدئو)](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

### **امنیت DevOps و زنجیره تأمین**
- [امنیت Azure DevOps](https://azure.microsoft.com/products/devops)
- [امنیت Azure Repos](https://azure.microsoft.com/products/devops/repos/)
- [سفر امنیت زنجیره تأمین مایکروسافت](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)

## **مستندات امنیتی اضافی**

برای راهنمایی جامع امنیتی، به این اسناد تخصصی در این بخش مراجعه کنید:

- **[بهترین شیوه‌های امنیتی MCP ۲۰۲۵](./mcp-security-best-practices-2025.md)** - بهترین شیوه‌های کامل امنیتی برای پیاده‌سازی‌های MCP  
- **[پیاده‌سازی ایمنی محتوا Azure](./azure-content-safety-implementation.md)** - نمونه‌های عملی پیاده‌سازی برای ادغام ایمنی محتوا Azure  
- **[کنترل‌های امنیتی MCP ۲۰۲۵](./mcp-security-controls-2025.md)** - جدیدترین کنترل‌ها و تکنیک‌های امنیتی برای استقرارهای MCP  
- **[مرجع سریع بهترین شیوه‌های MCP](./mcp-best-practices.md)** - راهنمای مرجع سریع برای شیوه‌های ضروری امنیتی MCP

---

## مرحله بعد

بعدی: [فصل ۳: شروع به کار](../03-GettingStarted/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**سلب مسئولیت**:  
این سند با استفاده از سرویس ترجمه هوش مصنوعی [Co-op Translator](https://github.com/Azure/co-op-translator) ترجمه شده است. در حالی که ما در تلاش برای دقت هستیم، لطفاً توجه داشته باشید که ترجمه‌های خودکار ممکن است حاوی خطاها یا نادرستی‌هایی باشند. سند اصلی به زبان بومی خود باید به عنوان منبع معتبر در نظر گرفته شود. برای اطلاعات حیاتی، ترجمه حرفه‌ای انسانی توصیه می‌شود. ما مسئول هیچ گونه سوءتفاهم یا تفسیر نادرستی که از استفاده این ترجمه ناشی شود، نیستیم.
<!-- CO-OP TRANSLATOR DISCLAIMER END -->