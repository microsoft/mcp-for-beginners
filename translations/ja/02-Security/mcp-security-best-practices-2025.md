# MCP セキュリティベストプラクティス - 2025年12月更新

> **重要**: 本ドキュメントは最新の[MCP仕様 2025-11-25](https://spec.modelcontextprotocol.io/specification/2025-11-25/)のセキュリティ要件および公式の[MCPセキュリティベストプラクティス](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)を反映しています。常に最新のガイダンスについては現行の仕様を参照してください。

## MCP実装のための必須セキュリティプラクティス

Model Context Protocolは従来のソフトウェアセキュリティを超えた独自のセキュリティ課題をもたらします。これらのプラクティスは、基礎的なセキュリティ要件と、プロンプトインジェクション、ツールポイズニング、セッションハイジャック、混乱代理問題、トークンパススルーの脆弱性などMCP固有の脅威の両方に対応しています。

### **必須のセキュリティ要件**

**MCP仕様からの重要要件:**

### **必須のセキュリティ要件**

**MCP仕様からの重要要件:**

> **してはならない**: MCPサーバーは明示的にMCPサーバー向けに発行されていないトークンを受け入れてはならない  
>  
> **しなければならない**: 認可を実装するMCPサーバーはすべての受信リクエストを検証しなければならない  
>  
> **してはならない**: MCPサーバーは認証にセッションを使用してはならない  
>  
> **しなければならない**: 静的クライアントIDを使用するMCPプロキシサーバーは、動的に登録された各クライアントに対してユーザーの同意を取得しなければならない

---

## 1. **トークンセキュリティと認証**

**認証および認可コントロール:**
   - **厳格な認可レビュー**: MCPサーバーの認可ロジックを包括的に監査し、意図したユーザーとクライアントのみがリソースにアクセスできることを保証する  
   - **外部IDプロバイダー統合**: カスタム認証の実装ではなく、Microsoft Entra IDなどの確立されたIDプロバイダーを使用する  
   - **トークンのオーディエンス検証**: トークンが明示的に自分のMCPサーバー向けに発行されたことを常に検証し、上流のトークンは決して受け入れない  
   - **適切なトークンライフサイクル**: 安全なトークンローテーション、有効期限ポリシーの実装、およびトークンリプレイ攻撃の防止

**保護されたトークンストレージ:**
   - すべてのシークレットにAzure Key Vaultや同様の安全な資格情報ストアを使用  
   - トークンの保存時および転送時の暗号化を実装  
   - 定期的な資格情報ローテーションと不正アクセスの監視

## 2. **セッション管理とトランスポートセキュリティ**

**安全なセッションプラクティス:**
   - **暗号学的に安全なセッションID**: 安全な乱数生成器で生成された安全かつ非決定論的なセッションIDを使用  
   - **ユーザー固有のバインディング**: `<user_id>:<session_id>`のような形式でセッションIDをユーザーIDに紐付け、ユーザー間のセッション悪用を防止  
   - **セッションライフサイクル管理**: 適切な有効期限設定、ローテーション、無効化を実装し脆弱性の窓を制限  
   - **HTTPS/TLSの強制**: セッションIDの傍受を防ぐため、すべての通信にHTTPSを必須化

**トランスポート層セキュリティ:**
   - 可能な限りTLS 1.3を設定し、適切な証明書管理を行う  
   - 重要な接続に対して証明書ピニングを実装  
   - 定期的な証明書ローテーションと有効性検証

## 3. **AI固有の脅威防御** 🤖

**プロンプトインジェクション防御:**
   - **Microsoft Prompt Shields**: 悪意ある指示の高度な検出とフィルタリングのためにAIプロンプトシールドを展開  
   - **入力のサニタイズ**: すべての入力を検証・サニタイズし、インジェクション攻撃や混乱代理問題を防止  
   - **コンテンツ境界**: 区切り文字やデータマーキングシステムを使用して信頼された指示と外部コンテンツを区別

**ツールポイズニング防止:**
   - **ツールメタデータ検証**: ツール定義の整合性チェックを実装し、予期しない変更を監視  
   - **動的ツール監視**: 実行時の挙動を監視し、予期しない実行パターンに対してアラートを設定  
   - **承認ワークフロー**: ツールの変更や機能変更に対して明示的なユーザー承認を要求

## 4. **アクセス制御と権限**

**最小権限の原則:**
   - MCPサーバーには意図された機能に必要な最小限の権限のみを付与  
   - 細かい権限を持つロールベースアクセス制御（RBAC）を実装  
   - 定期的な権限レビューと権限昇格の継続的監視

**実行時権限コントロール:**
   - リソース枯渇攻撃を防ぐためのリソース制限を適用  
   - ツール実行環境にコンテナ分離を使用  
   - 管理機能に対してジャストインタイムアクセスを実装

## 5. **コンテンツ安全性と監視**

**コンテンツ安全性の実装:**
   - **Azure Content Safety統合**: 有害コンテンツ、脱獄試行、ポリシー違反を検出するためにAzure Content Safetyを使用  
   - **行動分析**: MCPサーバーおよびツールの実行時の異常検知のための行動監視を実装  
   - **包括的なログ記録**: すべての認証試行、ツール呼び出し、セキュリティイベントを安全かつ改ざん防止のストレージに記録

**継続的監視:**
   - 不審なパターンや不正アクセス試行に対するリアルタイムアラート  
   - セキュリティイベント管理のためのSIEMシステムとの統合  
   - MCP実装の定期的なセキュリティ監査とペネトレーションテスト

## 6. **サプライチェーンセキュリティ**

**コンポーネント検証:**
   - **依存関係スキャン**: すべてのソフトウェア依存関係およびAIコンポーネントに対して自動脆弱性スキャンを実施  
   - **出所検証**: モデル、データソース、外部サービスの起源、ライセンス、整合性を検証  
   - **署名済みパッケージ**: 暗号的に署名されたパッケージを使用し、展開前に署名を検証

**安全な開発パイプライン:**
   - **GitHub Advanced Security**: シークレットスキャン、依存関係分析、CodeQL静的解析を実装  
   - **CI/CDセキュリティ**: 自動展開パイプライン全体でセキュリティ検証を統合  
   - **アーティファクト整合性**: 展開されたアーティファクトと構成の暗号的検証を実装

## 7. **OAuthセキュリティと混乱代理防止**

**OAuth 2.1実装:**
   - **PKCE実装**: すべての認可リクエストにProof Key for Code Exchange (PKCE)を使用  
   - **明示的同意**: 混乱代理攻撃を防ぐために動的に登録された各クライアントに対してユーザーの同意を取得  
   - **リダイレクトURI検証**: リダイレクトURIおよびクライアント識別子の厳格な検証を実装

**プロキシセキュリティ:**
   - 静的クライアントIDの悪用による認可バイパスを防止  
   - サードパーティAPIアクセスに対する適切な同意ワークフローを実装  
   - 認可コードの窃盗や不正APIアクセスを監視

## 8. **インシデント対応と復旧**

**迅速な対応能力:**
   - **自動化対応**: 資格情報ローテーションや脅威封じ込めのための自動システムを実装  
   - **ロールバック手順**: 既知の正常な構成やコンポーネントに迅速に戻す能力  
   - **フォレンジック機能**: インシデント調査のための詳細な監査証跡とログ記録

**コミュニケーションと調整:**
   - セキュリティインシデントのための明確なエスカレーション手順  
   - 組織のインシデント対応チームとの統合  
   - 定期的なセキュリティインシデントシミュレーションおよびテーブルトップ演習

## 9. **コンプライアンスとガバナンス**

**規制遵守:**
   - MCP実装が業界固有の要件（GDPR、HIPAA、SOC 2）を満たすことを保証  
   - AIデータ処理のためのデータ分類およびプライバシーコントロールを実装  
   - コンプライアンス監査のための包括的なドキュメントを維持

**変更管理:**
   - すべてのMCPシステム変更に対する正式なセキュリティレビュー手順  
   - 構成変更のバージョン管理および承認ワークフロー  
   - 定期的なコンプライアンス評価とギャップ分析

## 10. **高度なセキュリティコントロール**

**ゼロトラストアーキテクチャ:**
   - **決して信頼せず、常に検証**: ユーザー、デバイス、接続の継続的検証  
   - **マイクロセグメンテーション**: 個々のMCPコンポーネントを分離する詳細なネットワーク制御  
   - **条件付きアクセス**: 現在のコンテキストと行動に適応するリスクベースのアクセス制御

**実行時アプリケーション保護:**
   - **Runtime Application Self-Protection (RASP)**: リアルタイム脅威検出のためにRASP技術を展開  
   - **アプリケーションパフォーマンス監視**: 攻撃を示す可能性のあるパフォーマンス異常を監視  
   - **動的セキュリティポリシー**: 現在の脅威状況に基づいて適応するセキュリティポリシーを実装

## 11. **Microsoftセキュリティエコシステム統合**

**包括的なMicrosoftセキュリティ:**
   - **Microsoft Defender for Cloud**: MCPワークロードのクラウドセキュリティ姿勢管理  
   - **Azure Sentinel**: 高度な脅威検出のためのクラウドネイティブSIEMおよびSOAR機能  
   - **Microsoft Purview**: AIワークフローおよびデータソースのデータガバナンスとコンプライアンス

**アイデンティティおよびアクセス管理:**
   - **Microsoft Entra ID**: 条件付きアクセスポリシーを備えたエンタープライズアイデンティティ管理  
   - **Privileged Identity Management (PIM)**: 管理機能のジャストインタイムアクセスおよび承認ワークフロー  
   - **Identity Protection**: リスクベースの条件付きアクセスと自動脅威対応

## 12. **継続的なセキュリティ進化**

**最新の維持:**
   - **仕様の監視**: MCP仕様の更新およびセキュリティガイダンスの変更を定期的にレビュー  
   - **脅威インテリジェンス**: AI固有の脅威フィードおよび侵害指標の統合  
   - **セキュリティコミュニティ参加**: MCPセキュリティコミュニティおよび脆弱性開示プログラムへの積極的参加

**適応型セキュリティ:**
   - **機械学習セキュリティ**: 新規攻撃パターンの特定のためのMLベース異常検知の活用  
   - **予測的セキュリティ分析**: 先制的な脅威特定のための予測モデルの実装  
   - **セキュリティ自動化**: 脅威インテリジェンスおよび仕様変更に基づくセキュリティポリシーの自動更新

---

## **重要なセキュリティリソース**

### **公式MCPドキュメント**
- [MCP仕様 (2025-11-25)](https://spec.modelcontextprotocol.io/specification/2025-11-25/)
- [MCPセキュリティベストプラクティス](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)
- [MCP認可仕様](https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization)

### **Microsoftセキュリティソリューション**
- [Microsoft Prompt Shields](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [Azure Content Safety](https://learn.microsoft.com/azure/ai-services/content-safety/)
- [Microsoft Entra IDセキュリティ](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [GitHub Advanced Security](https://github.com/security/advanced-security)

### **セキュリティ標準**
- [OAuth 2.0 セキュリティベストプラクティス (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [大規模言語モデル向けOWASPトップ10](https://genai.owasp.org/)
- [NIST AIリスク管理フレームワーク](https://www.nist.gov/itl/ai-risk-management-framework)

### **実装ガイド**
- [Azure API Management MCP認証ゲートウェイ](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Microsoft Entra IDとMCPサーバー](https://den.dev/blog/mcp-server-auth-entra-id-session/)

---

> **セキュリティ通知**: MCPのセキュリティプラクティスは急速に進化しています。実装前に必ず現行の[MCP仕様](https://spec.modelcontextprotocol.io/)および[公式セキュリティドキュメント](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)を確認してください。

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**免責事項**：  
本書類はAI翻訳サービス「Co-op Translator」（https://github.com/Azure/co-op-translator）を使用して翻訳されました。正確性の向上に努めておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。原文の言語による文書が正式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用により生じた誤解や誤訳について、当方は一切の責任を負いかねます。
<!-- CO-OP TRANSLATOR DISCLAIMER END -->