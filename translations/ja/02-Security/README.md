# MCP セキュリティ: AI システムの包括的保護

[![MCP Security Best Practices](../../../translated_images/ja/03.175aed6dedae133f9d41e49cefd0f0a9a39c3317e1eaa7ef7182696af7534308.png)](https://youtu.be/88No8pw706o)

_(上の画像をクリックすると、このレッスンのビデオが表示されます)_

セキュリティは AI システム設計の基本であり、これが私たちが第 2 セクションとして優先する理由です。これは Microsoft の [Secure Future Initiative](https://www.microsoft.com/security/blog/2025/04/17/microsofts-secure-by-design-journey-one-year-of-success/) にある **Secure by Design** の原則と一致しています。

Model Context Protocol (MCP) は AI 駆動アプリケーションに強力な新機能をもたらす一方で、従来のソフトウェアリスクを超えた独自のセキュリティ課題ももたらします。MCP システムは確立されたセキュリティ上の懸念（安全なコーディング、最小権限、サプライチェーンセキュリティ）と、プロンプトインジェクション、ツールポイズニング、セッションハイジャック、混乱代理攻撃、トークンパススルーの脆弱性、動的な機能変更などの AI 特有の脅威の両方に直面しています。

このレッスンでは、MCP 実装における最も重要なセキュリティリスクを探り、認証、認可、過剰な権限、間接的なプロンプトインジェクション、セッションセキュリティ、混乱代理問題、トークン管理、サプライチェーンの脆弱性をカバーします。Microsoft の Prompt Shields、Azure Content Safety、GitHub Advanced Security などのソリューションを活用しながら、これらのリスクを軽減するための実践的なコントロールとベストプラクティスを学びます。

## 学習目標

このレッスンの終了時には、以下ができるようになります：

- **MCP 特有の脅威の特定**：プロンプトインジェクション、ツールポイズニング、過剰な権限、セッションハイジャック、混乱代理問題、トークンパススルーの脆弱性、サプライチェーンリスクなど、MCP システムに固有のセキュリティリスクを認識する
- **セキュリティコントロールの適用**：堅牢な認証、最小権限アクセス、安全なトークン管理、セッションセキュリティコントロール、サプライチェーン検証などの効果的な緩和策を実装する
- **Microsoft セキュリティソリューションの活用**：MCP ワークロード保護のために Microsoft Prompt Shields、Azure Content Safety、GitHub Advanced Security を理解し展開する
- **ツールセキュリティの検証**：ツールのメタデータ検証の重要性、動的変更の監視、間接的なプロンプトインジェクション攻撃への防御を認識する
- **ベストプラクティスの統合**：確立されたセキュリティの基本（安全なコーディング、サーバーハードニング、ゼロトラスト）と MCP 特有のコントロールを組み合わせて包括的な保護を実現する

# MCP セキュリティアーキテクチャとコントロール

最新の MCP 実装には、従来のソフトウェアセキュリティと AI 特有の脅威の両方に対応する多層的なセキュリティアプローチが必要です。急速に進化する MCP 仕様はセキュリティコントロールを成熟させ続けており、企業のセキュリティアーキテクチャや確立されたベストプラクティスとの統合を促進しています。

[Microsoft Digital Defense Report](https://aka.ms/mddr) の調査によると、**報告された侵害の 98% は堅牢なセキュリティ衛生によって防止可能**です。最も効果的な保護戦略は、基礎的なセキュリティ実践と MCP 特有のコントロールを組み合わせることであり、実証済みのベースラインセキュリティ対策が全体的なリスク低減に最も大きな影響を与えます。

## 現在のセキュリティ状況

> **注意:** この情報は **2025年12月18日** 時点の MCP セキュリティ標準を反映しています。MCP プロトコルは急速に進化しており、将来の実装では新しい認証パターンや強化されたコントロールが導入される可能性があります。最新のガイダンスについては、常に現在の [MCP 仕様](https://spec.modelcontextprotocol.io/)、[MCP GitHub リポジトリ](https://github.com/modelcontextprotocol)、および [セキュリティベストプラクティス文書](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices) を参照してください。

### MCP 認証の進化

MCP 仕様は認証と認可のアプローチにおいて大きく進化しています：

- **初期のアプローチ**：初期仕様では開発者がカスタム認証サーバーを実装する必要があり、MCP サーバーは OAuth 2.0 認可サーバーとしてユーザー認証を直接管理していました
- **現在の標準 (2025-11-25)**：更新された仕様では MCP サーバーが外部のアイデンティティプロバイダー（Microsoft Entra ID など）に認証を委任できるようになり、セキュリティ姿勢が向上し実装の複雑さが軽減されました
- **トランスポート層セキュリティ**：ローカル（STDIO）およびリモート（Streamable HTTP）接続の両方に対して適切な認証パターンを備えた安全なトランスポートメカニズムのサポートが強化されました

## 認証と認可のセキュリティ

### 現在のセキュリティ課題

最新の MCP 実装は複数の認証および認可の課題に直面しています：

### リスクと脅威ベクトル

- **誤設定された認可ロジック**：MCP サーバーの認可実装の欠陥により、機密データが露出したりアクセス制御が誤って適用されたりする可能性があります
- **OAuth トークンの侵害**：ローカル MCP サーバーのトークンが盗まれると、攻撃者がサーバーを偽装し下流サービスにアクセスできるようになります
- **トークンパススルーの脆弱性**：不適切なトークン処理によりセキュリティコントロールの回避や責任追跡の欠如が生じます
- **過剰な権限**：権限が過剰な MCP サーバーは最小権限の原則に違反し、攻撃対象領域を拡大します

#### トークンパススルー：重大なアンチパターン

**トークンパススルーは現在の MCP 認可仕様で明確に禁止されています**。これは重大なセキュリティ上の影響があるためです：

##### セキュリティコントロールの回避
- MCP サーバーおよび下流 API は、レート制限、リクエスト検証、トラフィック監視などの重要なセキュリティコントロールを適切なトークン検証に依存しています
- クライアントから API への直接トークン使用はこれらの保護を回避し、セキュリティアーキテクチャを損ないます

##### 責任追跡と監査の課題  
- MCP サーバーは上流発行トークンを使用するクライアントを区別できず、監査トレイルが破綻します
- 下流リソースサーバーのログは実際の MCP サーバー仲介者ではなく誤ったリクエスト元を示します
- インシデント調査やコンプライアンス監査が著しく困難になります

##### データ流出リスク
- 検証されていないトークンクレームにより、盗まれたトークンを持つ悪意のある者が MCP サーバーをデータ流出のプロキシとして利用できます
- 信頼境界の違反により、意図されたセキュリティコントロールを回避する不正アクセスパターンが発生します

##### 複数サービスへの攻撃ベクトル
- 複数のサービスで受け入れられる侵害トークンにより、接続されたシステム間での横移動が可能になります
- トークンの起源が検証できない場合、サービス間の信頼前提が破られる可能性があります

### セキュリティコントロールと緩和策

**重要なセキュリティ要件：**

> **必須**：MCP サーバーは MCP サーバー用に明示的に発行されていないトークンを**絶対に受け入れてはなりません**

#### 認証と認可のコントロール

- **厳格な認可レビュー**：MCP サーバーの認可ロジックを包括的に監査し、意図したユーザーとクライアントのみが機密リソースにアクセスできることを保証する
  - **実装ガイド**：[Azure API Management を MCP サーバーの認証ゲートウェイとして使用](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
  - **アイデンティティ統合**：[Microsoft Entra ID を MCP サーバー認証に使用](https://den.dev/blog/mcp-server-auth-entra-id-session/)

- **安全なトークン管理**：[Microsoft のトークン検証とライフサイクルベストプラクティス](https://learn.microsoft.com/en-us/entra/identity-platform/access-tokens) を実装
  - トークンのオーディエンスクレームが MCP サーバーの ID と一致することを検証
  - 適切なトークンローテーションと有効期限ポリシーを実施
  - トークンのリプレイ攻撃や不正使用を防止

- **保護されたトークンストレージ**：保存時および転送時の暗号化による安全なトークン保管
  - **ベストプラクティス**：[安全なトークンストレージと暗号化ガイドライン](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

#### アクセス制御の実装

- **最小権限の原則**：MCP サーバーに対して意図された機能に必要な最小限の権限のみを付与
  - 権限の定期的なレビューと更新で権限の肥大化を防止
  - **Microsoft ドキュメント**：[安全な最小権限アクセス](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)

- **ロールベースアクセス制御 (RBAC)**：細かいロール割り当てを実装
  - 特定のリソースとアクションにロールを厳密にスコープ
  - 攻撃対象領域を拡大する広範または不要な権限を避ける

- **継続的な権限監視**：アクセス監査と監視を継続的に実施
  - 権限使用パターンの異常を監視
  - 過剰または未使用の権限を迅速に是正

## AI 特有のセキュリティ脅威

### プロンプトインジェクションとツール操作攻撃

最新の MCP 実装は、従来のセキュリティ対策では完全に対処できない高度な AI 特有の攻撃ベクトルに直面しています：

#### **間接的プロンプトインジェクション（クロスドメインプロンプトインジェクション）**

**間接的プロンプトインジェクション**は MCP 対応 AI システムにおける最も重大な脆弱性の一つです。攻撃者は外部コンテンツ（文書、ウェブページ、メール、データソース）に悪意のある指示を埋め込み、AI システムがそれを正当なコマンドとして処理します。

**攻撃シナリオ：**
- **文書ベースのインジェクション**：処理される文書内に隠された悪意のある指示が意図しない AI 動作を引き起こす
- **ウェブコンテンツの悪用**：スクレイピング時に AI の挙動を操作する埋め込みプロンプトを含む改ざんされたウェブページ
- **メールベースの攻撃**：AI アシスタントが情報漏洩や不正操作を行う原因となる悪意のあるメール内プロンプト
- **データソース汚染**：汚染されたデータベースや API が AI システムに汚染コンテンツを提供

**実際の影響**：これらの攻撃はデータ流出、プライバシー侵害、有害コンテンツの生成、ユーザーインタラクションの操作を引き起こす可能性があります。詳細な分析は [Prompt Injection in MCP (Simon Willison)](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/) を参照してください。

![Prompt Injection Attack Diagram](../../../translated_images/ja/prompt-injection.ed9fbfde297ca877c15bc6daa808681cd3c3dc7bf27bbbda342ef1ba5fc4f52d.png)

#### **ツールポイズニング攻撃**

**ツールポイズニング**は MCP ツールを定義するメタデータを標的とし、LLM がツールの説明やパラメーターを解釈して実行判断を行う仕組みを悪用します。

**攻撃メカニズム：**
- **メタデータ操作**：攻撃者がツールの説明、パラメーター定義、使用例に悪意のある指示を注入
- **不可視の指示**：AI モデルが処理するが人間ユーザーには見えないツールメタデータ内の隠れたプロンプト
- **動的ツール変更（「ラグプル」）**：ユーザーが承認したツールが後に悪意のある動作を行うよう変更される
- **パラメーターインジェクション**：モデルの挙動に影響を与えるツールパラメータースキーマ内の悪意ある内容

**ホスト型サーバーのリスク**：リモート MCP サーバーは、ユーザー承認後にツール定義が更新される可能性があり、以前は安全だったツールが悪意のあるものになるシナリオを生み出します。詳細な分析は [Tool Poisoning Attacks (Invariant Labs)](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks) を参照してください。

![Tool Injection Attack Diagram](../../../translated_images/ja/tool-injection.3b0b4a6b24de6befe7d3afdeae44138ef005881aebcfc84c6f61369ce31e3640.png)

#### **その他の AI 攻撃ベクトル**

- **クロスドメインプロンプトインジェクション (XPIA)**：複数ドメインのコンテンツを利用してセキュリティコントロールを回避する高度な攻撃
- **動的機能変更**：初期のセキュリティ評価を逃れるリアルタイムのツール機能変更
- **コンテキストウィンドウポイズニング**：大規模コンテキストウィンドウを操作して悪意のある指示を隠す攻撃
- **モデル混乱攻撃**：モデルの制限を悪用して予測不可能または安全でない挙動を引き起こす

### AI セキュリティリスクの影響

**高影響の結果：**
- **データ流出**：機密の企業データや個人データへの不正アクセスと窃取
- **プライバシー侵害**：個人識別情報（PII）や機密ビジネスデータの露出
- **システム操作**：重要システムやワークフローの意図しない変更
- **認証情報の窃取**：認証トークンやサービス認証情報の侵害
- **横移動**：侵害された AI システムを足掛かりにしたネットワーク全体への攻撃拡大

### Microsoft AI セキュリティソリューション

#### **AI Prompt Shields：インジェクション攻撃に対する高度な防御**

Microsoft の **AI Prompt Shields** は、直接的および間接的なプロンプトインジェクション攻撃に対して多層的なセキュリティを提供します：

##### **コア保護メカニズム：**

1. **高度な検出とフィルタリング**
   - 機械学習アルゴリズムと NLP 技術により外部コンテンツ内の悪意ある指示を検出
   - 文書、ウェブページ、メール、データソースのリアルタイム分析
   - 正当なプロンプトパターンと悪意あるパターンの文脈的理解

2. **スポットライト技術**  
   - 信頼されたシステム指示と潜在的に汚染された外部入力を区別
   - モデルの関連性を高めつつ悪意あるコンテンツを分離するテキスト変換手法
   - AI システムが適切な指示階層を維持し、注入コマンドを無視するのを支援

3. **区切り文字とデータマーキングシステム**
   - 信頼されたシステムメッセージと外部入力テキストの明示的な境界定義
   - 信頼済みと未信頼データソース間の境界を示す特別なマーカー
   - 指示の混乱や不正なコマンド実行を防止

4. **継続的な脅威インテリジェンス**
   - Microsoft は新たな攻撃パターンを継続的に監視し防御を更新
   - 新しいインジェクション技術や攻撃ベクトルの積極的な脅威ハンティング
   - 進化する脅威に対抗するための定期的なセキュリティモデル更新

5. **Azure Content Safety 統合**
   - 包括的な Azure AI Content Safety スイートの一部
   - ジェイルブレイク試行、有害コンテンツ、セキュリティポリシー違反の追加検出
   - AI アプリケーションコンポーネント全体で統一されたセキュリティコントロール

**実装リソース**：[Microsoft Prompt Shields ドキュメント](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)

![Microsoft Prompt Shields Protection](../../../translated_images/ja/prompt-shield.ff5b95be76e9c78c6ec0888206a4a6a0a5ab4bb787832a9eceef7a62fe0138d1.png)


## 高度な MCP セキュリティ脅威

### セッションハイジャックの脆弱性

**セッションハイジャック**は、状態を持つ MCP 実装における重大な攻撃ベクトルであり、不正な第三者が正当なセッション識別子を取得・悪用してクライアントを偽装し、不正な操作を行います。

#### **攻撃シナリオとリスク**

- **セッションハイジャックによるプロンプトインジェクション**：盗まれたセッション ID を持つ攻撃者がセッション状態を共有するサーバーに悪意のあるイベントを注入し、有害な動作や機密データへのアクセスを引き起こす可能性
- **直接的ななりすまし**：盗まれたセッション ID により認証を回避して MCP サーバー呼び出しを行い、攻撃者を正当なユーザーとして扱う
- **再開可能なストリームの侵害**：攻撃者がリクエストを早期終了させ、正当なクライアントが潜在的に悪意のあるコンテンツで再開する状況を作り出す

#### **セッション管理のためのセキュリティコントロール**

**重要な要件：**
- **認可検証**: 認可を実装するMCPサーバーは、すべての受信リクエストを検証し、認証にセッションを利用してはならない  
- **安全なセッション生成**: 暗号学的に安全で非決定論的なセッションIDを、安全な乱数生成器で生成すること  
- **ユーザー固有のバインディング**: セッションIDを `<user_id>:<session_id>` のような形式でユーザー固有情報に紐付け、ユーザー間のセッション悪用を防止する  
- **セッションライフサイクル管理**: 脆弱性の窓口を制限するために、適切な有効期限設定、ローテーション、無効化を実装する  
- **通信の安全性**: セッションIDの傍受を防ぐため、すべての通信にHTTPSを必須とする  

### 混乱代理問題

**混乱代理問題**は、MCPサーバーがクライアントとサードパーティサービス間の認証プロキシとして機能する際に発生し、静的クライアントIDの悪用による認可回避の機会を生み出す。

#### **攻撃の仕組みとリスク**

- **クッキーによる同意回避**: 以前のユーザー認証で作成された同意クッキーを、攻撃者が悪意のある認可リクエストと細工されたリダイレクトURIで悪用する  
- **認可コードの窃取**: 既存の同意クッキーにより認可サーバーが同意画面をスキップし、コードを攻撃者管理のエンドポイントにリダイレクトする  
- **不正なAPIアクセス**: 窃取した認可コードでトークン交換を行い、明示的な承認なしにユーザーになりすます  

#### **緩和策**

**必須の対策:**
- **明示的な同意の取得**: 静的クライアントIDを使用するMCPプロキシサーバーは、動的に登録された各クライアントに対してユーザーの同意を必ず取得すること  
- **OAuth 2.1のセキュリティ実装**: すべての認可リクエストにPKCE（Proof Key for Code Exchange）を含む最新のOAuthセキュリティベストプラクティスを適用する  
- **厳格なクライアント検証**: リダイレクトURIやクライアント識別子の厳密な検証を実装し、悪用を防止する  

### トークンパススルーの脆弱性

**トークンパススルー**は、MCPサーバーがクライアントトークンを適切に検証せずに受け入れ、下流のAPIに転送する明確なアンチパターンであり、MCP認可仕様に違反する。

#### **セキュリティ上の影響**

- **制御回避**: クライアントからAPIへの直接トークン使用により、重要なレート制限、検証、監視制御を回避する  
- **監査証跡の破壊**: 上流発行のトークンによりクライアント識別が不可能となり、インシデント調査能力が損なわれる  
- **プロキシを利用したデータ流出**: 検証されていないトークンにより、悪意ある者がサーバーを不正データアクセスのプロキシとして利用可能になる  
- **信頼境界の侵害**: トークンの発行元が検証できない場合、下流サービスの信頼前提が破られる  
- **マルチサービス攻撃拡大**: 複数サービスで受け入れられた侵害トークンにより、横展開が可能になる  

#### **必須のセキュリティ対策**

**譲れない要件:**
- **トークン検証**: MCPサーバーは、明示的にMCPサーバー向けに発行されたトークン以外を受け入れてはならない  
- **オーディエンス検証**: トークンのaudクレームがMCPサーバーのIDと一致することを常に検証する  
- **適切なトークンライフサイクル**: 短命なアクセストークンと安全なローテーションを実装する  

## AIシステムのサプライチェーンセキュリティ

サプライチェーンセキュリティは従来のソフトウェア依存関係を超え、AIエコシステム全体を包含するように進化している。現代のMCP実装は、システムの整合性を損なう可能性のあるすべてのAI関連コンポーネントを厳密に検証・監視しなければならない。

### 拡張されたAIサプライチェーン構成要素

**従来のソフトウェア依存関係:**
- オープンソースライブラリとフレームワーク  
- コンテナイメージとベースシステム  
- 開発ツールとビルドパイプライン  
- インフラストラクチャコンポーネントとサービス  

**AI固有のサプライチェーン要素:**
- **ファウンデーションモデル**: 由来検証が必要な各種プロバイダーの事前学習済みモデル  
- **埋め込みサービス**: 外部のベクトル化およびセマンティック検索サービス  
- **コンテキストプロバイダー**: データソース、ナレッジベース、ドキュメントリポジトリ  
- **サードパーティAPI**: 外部AIサービス、MLパイプライン、データ処理エンドポイント  
- **モデルアーティファクト**: 重み、設定、ファインチューニング済みモデルのバリアント  
- **トレーニングデータソース**: モデルの学習およびファインチューニングに使用されるデータセット  

### 包括的なサプライチェーンセキュリティ戦略

#### **コンポーネント検証と信頼**

- **由来検証**: すべてのAIコンポーネントの起源、ライセンス、整合性を統合前に検証する  
- **セキュリティ評価**: モデル、データソース、AIサービスに対する脆弱性スキャンとセキュリティレビューを実施する  
- **評判分析**: AIサービスプロバイダーのセキュリティ実績と運用慣行を評価する  
- **コンプライアンス検証**: すべてのコンポーネントが組織のセキュリティおよび規制要件を満たしていることを確認する  

#### **安全なデプロイメントパイプライン**

- **自動化されたCI/CDセキュリティ**: 自動化されたデプロイメントパイプライン全体にセキュリティスキャンを統合する  
- **アーティファクトの整合性**: すべてのデプロイ済みアーティファクト（コード、モデル、設定）に暗号学的検証を実装する  
- **段階的デプロイ**: 各段階でセキュリティ検証を行う段階的デプロイ戦略を採用する  
- **信頼されたアーティファクトリポジトリ**: 検証済みで安全なアーティファクトレジストリおよびリポジトリからのみデプロイする  

#### **継続的な監視と対応**

- **依存関係スキャン**: すべてのソフトウェアおよびAIコンポーネント依存関係の脆弱性を継続的に監視する  
- **モデル監視**: モデルの挙動、性能のドリフト、セキュリティ異常を継続的に評価する  
- **サービスヘルストラッキング**: 外部AIサービスの可用性、セキュリティインシデント、ポリシー変更を監視する  
- **脅威インテリジェンス統合**: AIおよびMLのセキュリティリスクに特化した脅威フィードを組み込む  

#### **アクセス制御と最小権限**

- **コンポーネントレベルの権限**: ビジネス上必要な範囲でモデル、データ、サービスへのアクセスを制限する  
- **サービスアカウント管理**: 最小限の権限を持つ専用サービスアカウントを実装する  
- **ネットワーク分割**: AIコンポーネントを分離し、サービス間のネットワークアクセスを制限する  
- **APIゲートウェイ制御**: 外部AIサービスへのアクセスを制御・監視する集中APIゲートウェイを利用する  

#### **インシデント対応と復旧**

- **迅速な対応手順**: 侵害されたAIコンポーネントのパッチ適用または置換のための確立されたプロセス  
- **認証情報ローテーション**: シークレット、APIキー、サービス認証情報の自動ローテーションシステム  
- **ロールバック機能**: 既知の正常なバージョンに迅速に戻せる能力  
- **サプライチェーン侵害復旧**: 上流AIサービスの侵害に対応するための特定手順  

### Microsoftのセキュリティツールと統合

**GitHub Advanced Security** は包括的なサプライチェーン保護を提供し、以下を含む:  
- **シークレットスキャン**: リポジトリ内の認証情報、APIキー、トークンの自動検出  
- **依存関係スキャン**: オープンソース依存関係とライブラリの脆弱性評価  
- **CodeQL解析**: セキュリティ脆弱性やコーディング問題の静的コード解析  
- **サプライチェーンインサイト**: 依存関係の健全性とセキュリティ状況の可視化  

**Azure DevOps & Azure Repos統合:**  
- Microsoft開発プラットフォーム全体でのシームレスなセキュリティスキャン統合  
- AIワークロード向けAzure Pipelinesでの自動セキュリティチェック  
- 安全なAIコンポーネントデプロイメントのためのポリシー強制  

**Microsoft社内の実践:**  
Microsoftはすべての製品で広範なサプライチェーンセキュリティ対策を実施している。詳細は[Microsoftにおけるソフトウェアサプライチェーンのセキュリティ強化の旅](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)を参照。  

## 基盤的なセキュリティベストプラクティス

MCP実装は組織の既存のセキュリティ体制を継承し強化する。基盤的なセキュリティ実践を強化することで、AIシステムおよびMCP展開の全体的なセキュリティが大幅に向上する。

### コアセキュリティの基本

#### **安全な開発慣行**

- **OWASP準拠**: [OWASP Top 10](https://owasp.org/www-project-top-ten/)のウェブアプリケーション脆弱性から保護  
- **AI固有の保護**: [LLM向けOWASP Top 10](https://genai.owasp.org/download/43299/?tmstv=1731900559)に対する対策を実装  
- **安全なシークレット管理**: トークン、APIキー、機密設定データ用の専用ボールトを使用  
- **エンドツーエンド暗号化**: すべてのアプリケーションコンポーネントとデータフローで安全な通信を実装  
- **入力検証**: すべてのユーザー入力、APIパラメーター、データソースを厳格に検証  

#### **インフラストラクチャの強化**

- **多要素認証**: すべての管理者およびサービスアカウントにMFAを必須化  
- **パッチ管理**: OS、フレームワーク、依存関係の自動かつ迅速なパッチ適用  
- **IDプロバイダー統合**: Microsoft Entra IDやActive Directoryなどの企業IDプロバイダーによる集中管理  
- **ネットワーク分割**: MCPコンポーネントの論理的分離により横展開を制限  
- **最小権限の原則**: すべてのシステムコンポーネントとアカウントに必要最小限の権限を付与  

#### **セキュリティ監視と検知**

- **包括的なログ記録**: MCPクライアント・サーバー間のやり取りを含むAIアプリケーション活動の詳細ログ  
- **SIEM統合**: 異常検知のための集中セキュリティ情報・イベント管理  
- **行動分析**: システムおよびユーザーの異常パターン検出にAIを活用  
- **脅威インテリジェンス**: 外部脅威フィードと侵害指標（IOC）の統合  
- **インシデント対応**: セキュリティインシデントの検知、対応、復旧の明確な手順  

#### **ゼロトラストアーキテクチャ**

- **決して信頼せず、常に検証**: ユーザー、デバイス、ネットワーク接続を継続的に検証  
- **マイクロセグメンテーション**: 個別のワークロードやサービスを分離する詳細なネットワーク制御  
- **アイデンティティ中心のセキュリティ**: ネットワーク位置ではなく検証済みアイデンティティに基づくポリシー  
- **継続的リスク評価**: 現状のコンテキストと行動に基づく動的なセキュリティ姿勢評価  
- **条件付きアクセス**: リスク要因、場所、デバイスの信頼性に応じて適応するアクセス制御  

### エンタープライズ統合パターン

#### **Microsoftセキュリティエコシステム統合**

- **Microsoft Defender for Cloud**: 包括的なクラウドセキュリティ姿勢管理  
- **Azure Sentinel**: AIワークロード保護のためのクラウドネイティブSIEMおよびSOAR機能  
- **Microsoft Entra ID**: 条件付きアクセスを備えた企業向けID・アクセス管理  
- **Azure Key Vault**: ハードウェアセキュリティモジュール（HSM）対応の集中シークレット管理  
- **Microsoft Purview**: AIデータソースとワークフローのデータガバナンスとコンプライアンス  

#### **コンプライアンスとガバナンス**

- **規制準拠**: MCP実装が業界固有のコンプライアンス要件（GDPR、HIPAA、SOC 2）を満たすことを保証  
- **データ分類**: AIシステムで処理される機密データの適切な分類と取り扱い  
- **監査証跡**: 規制遵守および法医学調査のための包括的なログ記録  
- **プライバシー制御**: AIシステム設計にプライバシーバイデザイン原則を実装  
- **変更管理**: AIシステム変更のセキュリティレビューのための正式なプロセス  

これらの基盤的実践は、MCP固有のセキュリティ制御の効果を高め、AI駆動アプリケーションに対する包括的な保護を提供する堅牢なセキュリティ基盤を構築する。  

## 重要なセキュリティポイント

- **多層防御アプローチ**: 基盤的なセキュリティ実践（安全なコーディング、最小権限、サプライチェーン検証、継続的監視）とAI固有の制御を組み合わせて包括的な保護を実現  
- **AI固有の脅威環境**: MCPシステムはプロンプトインジェクション、ツールポイズニング、セッションハイジャック、混乱代理問題、トークンパススルー脆弱性、過剰権限などの固有リスクに直面し、専門的な緩和策が必要  
- **認証・認可の徹底**: 外部IDプロバイダー（Microsoft Entra ID）を用いた堅牢な認証、適切なトークン検証の実施、MCPサーバー向けに明示的に発行されたトークンのみを受け入れること  
- **AI攻撃防止**: Microsoft Prompt ShieldsおよびAzure Content Safetyを展開し、間接的なプロンプトインジェクションやツールポイズニング攻撃を防御、ツールメタデータの検証と動的変化の監視を行う  
- **セッションと通信の安全性**: 暗号学的に安全で非決定論的なユーザーIDに紐付くセッションIDを使用し、適切なセッションライフサイクル管理を実装、認証にセッションを使用しない  
- **OAuthセキュリティベストプラクティス**: 動的登録クライアントに対する明示的なユーザー同意、PKCEを含むOAuth 2.1の適切な実装、厳格なリダイレクトURI検証により混乱代理攻撃を防止  
- **トークンセキュリティ原則**: トークンパススルーのアンチパターンを避け、トークンのaudクレームを検証し、短命トークンと安全なローテーションを実装、明確な信頼境界を維持  
- **包括的なサプライチェーンセキュリティ**: モデル、埋め込み、コンテキストプロバイダー、外部APIなどすべてのAIエコシステムコンポーネントを従来のソフトウェア依存関係と同等の厳格なセキュリティで扱う  
- **継続的な進化**: 急速に進化するMCP仕様に追随し、セキュリティコミュニティ標準に貢献し、プロトコル成熟に伴い適応的なセキュリティ姿勢を維持  
- **Microsoftセキュリティ統合**: Microsoftの包括的なセキュリティエコシステム（Prompt Shields、Azure Content Safety、GitHub Advanced Security、Entra ID）を活用し、MCP展開の保護を強化  

## 包括的リソース

### **公式MCPセキュリティドキュメント**
- [MCP仕様（最新版: 2025-11-25）](https://spec.modelcontextprotocol.io/specification/2025-11-25/)
- [MCPセキュリティベストプラクティス](https://modelcontextprotocol.io/specification/2025-11-25/basic/security_best_practices)
- [MCP認可仕様](https://modelcontextprotocol.io/specification/2025-11-25/basic/authorization)
- [MCP GitHubリポジトリ](https://github.com/modelcontextprotocol)

### **セキュリティ標準とベストプラクティス**
- [OAuth 2.0 セキュリティベストプラクティス (RFC 9700)](https://datatracker.ietf.org/doc/html/rfc9700)
- [OWASP Top 10 ウェブアプリケーションセキュリティ](https://owasp.org/www-project-top-ten/)
- [LLM向けOWASP Top 10](https://genai.owasp.org/download/43299/?tmstv=1731900559)
- [Microsoft デジタルディフェンスレポート](https://aka.ms/mddr)

### **AIセキュリティ研究・分析**
- [MCPにおけるプロンプトインジェクション（Simon Willison）](https://simonwillison.net/2025/Apr/9/mcp-prompt-injection/)
- [ツールポイズニング攻撃（Invariant Labs）](https://invariantlabs.ai/blog/mcp-security-notification-tool-poisoning-attacks)
- [MCP セキュリティリサーチブリーフィング (Wiz Security)](https://www.wiz.io/blog/mcp-security-research-briefing#remote-servers-22)

### **Microsoft セキュリティソリューション**
- [Microsoft Prompt Shields ドキュメント](https://learn.microsoft.com/azure/ai-services/content-safety/concepts/jailbreak-detection)
- [Azure Content Safety サービス](https://learn.microsoft.com/azure/ai-services/content-safety/)
- [Microsoft Entra ID セキュリティ](https://learn.microsoft.com/entra/identity-platform/secure-least-privileged-access)
- [Azure トークン管理ベストプラクティス](https://learn.microsoft.com/entra/identity-platform/access-tokens)
- [GitHub Advanced Security](https://github.com/security/advanced-security)

### **実装ガイド & チュートリアル**
- [Azure API Management を MCP 認証ゲートウェイとして使用](https://techcommunity.microsoft.com/blog/integrationsonazureblog/azure-api-management-your-auth-gateway-for-mcp-servers/4402690)
- [Microsoft Entra ID 認証と MCP サーバー](https://den.dev/blog/mcp-server-auth-entra-id-session/)
- [安全なトークンストレージと暗号化（ビデオ）](https://youtu.be/uRdX37EcCwg?si=6fSChs1G4glwXRy2)

### **DevOps & サプライチェーンセキュリティ**
- [Azure DevOps セキュリティ](https://azure.microsoft.com/products/devops)
- [Azure Repos セキュリティ](https://azure.microsoft.com/products/devops/repos/)
- [Microsoft サプライチェーンセキュリティの取り組み](https://devblogs.microsoft.com/engineering-at-microsoft/the-journey-to-secure-the-software-supply-chain-at-microsoft/)

## **追加のセキュリティドキュメント**

包括的なセキュリティガイダンスについては、このセクションの専門ドキュメントを参照してください：

- **[MCP セキュリティベストプラクティス 2025](./mcp-security-best-practices-2025.md)** - MCP 実装のための完全なセキュリティベストプラクティス
- **[Azure Content Safety 実装](./azure-content-safety-implementation.md)** - Azure Content Safety 統合の実践的な実装例  
- **[MCP セキュリティコントロール 2025](./mcp-security-controls-2025.md)** - MCP 展開のための最新のセキュリティコントロールと技術
- **[MCP ベストプラクティス クイックリファレンス](./mcp-best-practices.md)** - 重要な MCP セキュリティプラクティスのクイックリファレンスガイド

---

## 次に進む

次へ: [第3章: はじめに](../03-GettingStarted/README.md)

---

<!-- CO-OP TRANSLATOR DISCLAIMER START -->
**免責事項**：  
本書類はAI翻訳サービス「Co-op Translator」（https://github.com/Azure/co-op-translator）を使用して翻訳されました。正確性の向上に努めておりますが、自動翻訳には誤りや不正確な部分が含まれる可能性があります。原文の言語による文書が正式な情報源とみなされるべきです。重要な情報については、専門の人間による翻訳を推奨します。本翻訳の利用により生じたいかなる誤解や誤訳についても、当方は一切の責任を負いかねます。
<!-- CO-OP TRANSLATOR DISCLAIMER END -->